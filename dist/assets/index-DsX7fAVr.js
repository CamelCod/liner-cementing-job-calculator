import{j as e,X as t,C as s,b as l,r as a,G as n,L as i,W as r,D as o,Z as d,P as c,B as m,d as u,e as p,T as h,I as x,f as g,h as b,i as f,k as j,l as v,m as y,R as N,M as w,n as F,F as S,o as C,p as k,q as D,s as T,t as L,u as M,v as P,w as A,x as O,U as R,y as I}from"./vendor-cFRcXG0Z.js";import{H as B,T as V,J as H,f as E}from"./vendor-misc-BJAQwVey.js";import{E as $,a as z}from"./pdf-3Ws1uFQd.js";import{R as W,P as q,a as _,C as U,T as G,L as Y}from"./charts-AcaWHLct.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))processPreload(e);new MutationObserver(e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&processPreload(e)}).observe(document,{childList:!0,subtree:!0})}function processPreload(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const K=["p","br","strong","b","em","i","u","span","div","h1","h2","h3","h4","h5","h6","ul","ol","li","table","thead","tbody","tr","td","th","sup","sub","code","pre"];function sanitizeHtml(e,t={}){const{allowedTags:s=K,stripUnknownTags:l=!0}=t;if(!e||"string"!=typeof e)return"";let a=e.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/\s+on\w+\s*=\s*["'][^"']*["']/gi,"").replace(/\s+on\w+\s*=\s*[^>\s]+/gi,"").replace(/href\s*=\s*["']javascript:[^"']*["']/gi,"").replace(/src\s*=\s*["']javascript:[^"']*["']/gi,"").replace(/href\s*=\s*["']data:[^"']*["']/gi,"").replace(/src\s*=\s*["']data:[^"']*["']/gi,"").replace(/style\s*=\s*["'][^"']*expression\([^"']*\)["']/gi,"").replace(/<meta[^>]*http-equiv\s*=\s*["']refresh["'][^>]*>/gi,"").replace(/<(embed|object|iframe|frame|frameset)[^>]*>[\s\S]*?<\/\1>/gi,"").replace(/<(embed|object|iframe|frame|frameset|link|base)[^>]*>/gi,"");return l&&(a=a.replace(/<\/?([a-zA-Z][a-zA-Z0-9]*)\b[^>]*>/g,(e,t)=>{const l=t.toLowerCase();return s.includes(l)?e:""})),a.trim()}function SafeHtml({html:t,className:s,sanitizeOptions:l,isMarkdown:a=!1}){const n=a?(i=t)&&"string"==typeof i?sanitizeHtml(i.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/^### (.*$)/gm,"<h3>$1</h3>").replace(/^## (.*$)/gm,"<h2>$1</h2>").replace(/^# (.*$)/gm,"<h1>$1</h1>").replace(/\n\n/g,"</p><p>").replace(/\n/g,"<br />").replace(/^(.+)$/gm,"<p>$1</p>").replace(/<\/p><p><h/g,"</p><h").replace(/<\/h([1-6])><p>/g,"</h$1><p>")):"":sanitizeHtml(t,l);var i;return e.jsx("div",{className:s,dangerouslySetInnerHTML:{__html:n}})}const J=(()=>{const e="AIzaSyCgdEX7PP28tsrpjUJ2ZQ3ZLkF0nvlgego".trim();return e&&e.startsWith("AIza"),e})(),Z=J?new B({apiKey:J}):null,degreesToRadians=e=>e*(Math.PI/180);function deg2rad(e){return e*Math.PI/180}function interpAtMD(e,t){var s;if(0===e.length)return null;const l=e[0],a=e[e.length-1];if(!l||!a)return null;if(t<=l.md)return l;if(t>=a.md)return a;let n=1;for(;n<e.length&&void 0!==(null==(s=e[n])?void 0:s.md)&&e[n].md<t;)n++;const i=e[n-1],r=e[n];if(!i||!r)return l;const o=(t-i.md)/(r.md-i.md);return{md:t,inc:i.inc+(r.inc-i.inc)*o,azi:i.azi+(r.azi-i.azi)*o}}function simulateSlackOffProfile(e){const{survey:t,toMD:s,segmentFt:l,muAt:a,w_buoyed_at:n,rotate:i,r_eff_ft:r,surfaceForce:o}=e,d=function(e,t,s){const l=[...e].sort((e,t)=>e.md-t.md);if(0===l.length)return[];const a=l[0],n=l[l.length-1];if(!a||!n)return[];const i=a.md,r=Math.min(s,n.md),o=[];let d=i;for(;d<r-1e-9;){const e=interpAtMD(l,d);e&&o.push({md:d,inc:e.inc}),d=Math.min(d+t,r)}const c=interpAtMD(l,r);return c&&o.push({md:r,inc:c.inc}),o}(t,l,s);if(0===d.length)return{series:[],forceAtTarget:o};let c=o,m=0;const u=d[0];if(!u)return{series:[],forceAtTarget:o};const p=[{md:u.md,tension:c,torque:m}];for(let x=1;x<d.length;x++){const e=d[x-1],t=d[x];if(!e||!t)continue;const s=.5*(e.md+t.md),l=t.md-e.md,o=deg2rad(t.inc),u=n(s),h=u*Math.cos(o),g=u*Math.sin(o),b=a(s)*g;c+=(h+b)*l,i&&(m+=b*r*l),p.push({md:t.md,tension:c,torque:m})}const h=p[p.length-1];return{series:p,forceAtTarget:(null==h?void 0:h.tension)||o}}const calculateTorqueDrag=e=>{const{survey:t,string:s,mudWeight:l,casingFriction:a,openHoleFriction:n,casingShoeMd:i,rotate:r=!0,targetSetdown:o=15e3,segmentFt:d=25}=e;if(t.length<2)return{plotData:[],summary:"Insufficient survey data for T&D calculation."};const c=t.map(e=>({md:e.md,inc:e.incl,azi:0})).sort((e,t)=>e.md-t.md),m=[...s].sort((e,t)=>t.to-e.to)[0]||s[0],u=((null==m?void 0:m.od)||0)/2/12;const p=((null==m?void 0:m.wt)||0)*(1-l/65.4),h=function(e,t,s,l){const a=[{fromMD:-1/0,toMD:t,mu:s},{fromMD:t,toMD:1/0,mu:l}];return t=>{for(const e of a)if(t>=e.fromMD&&t<=e.toMD)return e.mu;return e}}(a,i,a,n),x=c[c.length-1];if(!x)return{plotData:[],summary:"No survey data available"};const g=x.md,{series:b,surfaceForce:f}=function(e){const{survey:t,targetMD:s,segmentFt:l,muAt:a,w_buoyed_at:n,rotate:i,r_eff_ft:r,targetCompression:o}=e,d=-Math.abs(o);let c=0,m=1e6,u=[],p=m;for(let h=0;h<60;h++){const e=.5*(c+m),{series:o,forceAtTarget:h}=simulateSlackOffProfile({survey:t,toMD:s,segmentFt:l,muAt:a,w_buoyed_at:n,rotate:i,r_eff_ft:r,surfaceForce:e});if(h>d?m=e:c=e,u=o,p=e,Math.abs(h-d)<.001)break}return{converged:!0,surfaceForce:p,series:u}}({survey:c,targetMD:g,segmentFt:d,muAt:h,w_buoyed_at:e=>p,rotate:r,r_eff_ft:u,targetCompression:o}),j=b.map((e,t,s)=>{let l=0;if(t>0){const e=s[t-1];e&&(l=e.tension)}return{depth:e.md,hookload_in:0,hookload_out:e.tension,torque:e.torque,drag:t>0?Math.max(0,e.tension-l):0}}),v=j.reduce((e,t)=>Math.max(e,t.hookload_out),0),y=j.reduce((e,t)=>Math.max(e,t.torque),0),N=j.reduce((e,t)=>Math.max(e,t.drag),0);return{plotData:j,summary:`\n**T&D Analysis (Soft-string)**\n- Surface Setdown to reach target: ${f.toLocaleString(void 0,{maximumFractionDigits:0})} lbs\n- Max Hookload (tension at depth): ${v.toLocaleString(void 0,{maximumFractionDigits:0})} lbs\n- Max Surface Torque${r?"":" (rotation disabled)"}: ${y.toLocaleString(void 0,{maximumFractionDigits:0})} ft-lbs\n- Max Drag (approx): ${N.toLocaleString(void 0,{maximumFractionDigits:0})} lbs\n- Friction Factors: Cased ${a}, Open Hole ${n}\n`}},Modal$1=({title:s,onClose:l,children:a})=>e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full max-h-[90vh] overflow-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:s}),e.jsx("button",{onClick:l,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close modal",children:e.jsx(t,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"p-6",children:a})]})}),FluidControl=({label:t,count:a,setCount:n})=>e.jsxs("div",{className:"flex items-center justify-between p-2",children:[e.jsx("span",{className:"text-slate-700",children:t}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>n(Math.max(0,a-1)),"aria-label":`Decrease ${t}`,title:`Decrease ${t}`,className:"p-1 rounded-full bg-red-100 text-red-600 hover:bg-red-200 transition-colors",children:e.jsx(s,{size:20})}),e.jsx("span",{className:"font-bold w-4 text-center",children:a}),e.jsx("button",{onClick:()=>n(a+1),"aria-label":`Increase ${t}`,title:`Increase ${t}`,className:"p-1 rounded-full bg-green-100 text-green-600 hover:bg-green-200 transition-colors",children:e.jsx(l,{size:20})})]})]}),FluidInputs=({fluids:t,setFluids:s,label:l})=>{const updateFluid=(e,t,l)=>{s(s=>s.map((s,a)=>a===e?{...s,[t]:l}:s))};return e.jsxs("div",{className:"bg-slate-50 p-6 rounded-xl shadow-inner flex-1 min-w-[300px]",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-slate-700",children:l}),t.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-3",children:t.map((t,s)=>e.jsx("div",{className:"p-3 bg-slate-100 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 items-end",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Fluid"}),e.jsx("span",{className:"mt-1 block w-full p-2 border border-slate-300 rounded-md bg-slate-200 text-slate-700 text-center",children:t.label})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Volume (bbl)"}),e.jsx("input",{type:"number",value:t.volume,onChange:e=>updateFluid(s,"volume",e.target.value),className:"mt-1 block w-full p-2 border border-slate-300 rounded-md bg-white text-slate-900"})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Weight (ppg)"}),e.jsx("input",{type:"number",value:t.ppg,onChange:e=>updateFluid(s,"ppg",e.target.value),className:"mt-1 block w-full p-2 border border-slate-300 rounded-md bg-white text-slate-900"})]})]})},`${l}-${t.label}-${s}`))}):e.jsx("p",{className:"text-slate-500 text-sm",children:"No fluids configured."})]})},ResultTabButton=({label:t,value:s,icon:l,isActive:a,onClick:n})=>e.jsxs("button",{onClick:()=>n(s),className:"flex items-center gap-2 px-4 py-2 rounded-full transition-colors "+(a?"bg-white text-blue-600 shadow-sm border":"text-slate-600 hover:text-slate-800 hover:bg-slate-50"),children:[l,e.jsx("span",{className:"text-sm font-medium",children:t})]}),TermExplainerModal=({isVisible:t,termToExplain:s,explainedTerm:l,isExplaining:a,onClose:n,onTermChange:i,onExplain:r})=>{if(!t)return null;return e.jsxs(Modal$1,{title:"Explain a Drilling Term",onClose:n,children:[e.jsxs("label",{className:"block mb-2",children:[e.jsx("span",{className:"text-gray-600",children:"Enter a term:"}),e.jsx("input",{type:"text",value:s,onChange:e=>i(e.target.value),onKeyDown:e=>{"Enter"===e.key&&r()},className:"mt-1 block w-full p-2 border border-slate-300 rounded-md bg-white text-slate-900",placeholder:"e.g., 'Rat Hole'"})]}),e.jsx("button",{onClick:r,className:"w-full mt-2 flex items-center justify-center p-2 rounded-lg bg-blue-600 text-white font-medium hover:bg-blue-700 transition-colors",disabled:a||!s,children:a?"Explaining...":"Explain Term"}),l&&e.jsxs("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-green-800",children:s}),e.jsx("div",{className:"text-green-700 text-sm mt-1",dangerouslySetInnerHTML:{__html:l}})]})]})},X={cement:"#a16207",spacer:"#0ea5e9",mud:"#1e3a8a",drillPipe:"#334155"},bblPerFtAnnular$1=(e,t)=>.785*(Math.pow(e,2)-Math.pow(t,2))/1029.4,DepthLabel=({y:t,depth:s,label:l,align:a="left",center:n,casingWidth:i})=>{const r="left"===a?n+i/2+5:n-i/2-5,o="left"===a?n+140:n-140,d="left"===a?o+4:o-4,c="left"===a?"start":"end";return e.jsxs("g",{children:[e.jsx("line",{x1:r,y1:t,x2:o,y2:t,stroke:"#475569",strokeWidth:1,strokeDasharray:"3,3"}),e.jsxs("text",{x:d,y:t+4,textAnchor:c,className:"fill-slate-700 text-[10px] font-semibold",children:[l,": ",s.toFixed(0)," ft"]})]})},KeyMetrics=({calculations:t,tocMd:s})=>t?e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"TOC (MD)"}),e.jsxs("span",{className:"font-semibold",children:[s.toFixed(0)," ft"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Cement"}),e.jsxs("span",{className:"font-semibold",children:[t.totalCementVolumeBbl.toFixed(1)," bbl"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Excess Cement"}),e.jsxs("span",{className:"font-semibold",children:[t.excessCementBbl.toFixed(1)," bbl"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Rig Capacity Margin"}),e.jsxs("span",{className:"font-semibold",children:[t.rigCapacityMarginLbs.toFixed(0)," lbs"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Force Margin"}),e.jsxs("span",{className:"font-semibold",children:[t.forceMarginPct.toFixed(1)," %"]})]}),t.plugTravel&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-2 font-semibold text-slate-600",children:"Plug / Dart Travel"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Dart Launch Vol"}),e.jsxs("span",{className:"font-semibold",children:[t.plugTravel.dartLaunchVolumeBbl.toFixed(2)," bbl"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Latch MD"}),e.jsxs("span",{className:"font-semibold",children:[t.plugTravel.latchMd.toFixed(1)," ft"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Shear Success"}),e.jsx("span",{className:"font-semibold "+(t.plugTravel.shearSuccess?"text-green-600":"text-red-600"),children:t.plugTravel.shearSuccess?"Yes":"No"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Bump Reached"}),e.jsx("span",{className:"font-semibold "+(t.plugTravel.bumpReached?"text-green-600":"text-red-600"),children:t.plugTravel.bumpReached?"Yes":"No"})]})]})]}):e.jsx("p",{className:"text-xs text-slate-500",children:"No calculation results."}),WellAnalysisReport=({casing:t,liner:s,dp1:l,spacers:x,cements:g,displacements:b,holeOverlap:f,landingCollar:j,totalDepth:v,calculations:y})=>{const[N,w]=a.useState(!0),[F,S]=a.useState(!0),[C,k]=a.useState(!0),[D,T]=a.useState(!0),L=a.useRef(null),M=parseFloat(t.od||"0"),P=parseFloat(s.od||"0"),A=parseFloat(l.od||"0"),O=parseFloat(f.openHoleId||"0"),R=parseFloat(s.md||"0"),I=parseFloat(t.md||"0"),B=parseFloat(v.md||"0")-R||parseFloat(f.ratHoleLength||"0"),V=parseFloat(j.md||"0"),H=parseFloat(f.linerOverlap||"0"),E=600/(R+B+200),K=I,J=R,Z=(null==y?void 0:y.geometry.topOfLinerMd)||I-H,Q=J+B,ee=10*O,te=10*M,se=10*P,le=10*A,ae=260,ne=bblPerFtAnnular$1(O,P),ie=bblPerFtAnnular$1(parseFloat(t.id||"0"),P),{fluidLevels:re,tocMd:oe}=a.useMemo(()=>((e,t,s,l,a,n,i)=>{const r=[];let o=s,d=s;const c=[...e,...t],colorFor=e=>e.toLowerCase().includes("cement")?X.cement:X.spacer,fillOpenHole=(e,t)=>{if(o<=l||e<=0)return e;const s=(o-l)*n,a=colorFor(t);if(e<=s){const s=o-e/n;return r.push({top:s,bottom:o,color:a,label:t}),o=s,0}return r.push({top:l,bottom:o,color:a,label:t}),o=l,e-s},fillOverlap=(e,t)=>{if(e<=0||o>l)return;const s=o-e/i;r.push({top:s,bottom:o,color:colorFor(t),label:t}),o=s};for(const m of c){let e=parseFloat(m.volume||"0");e&&(e=fillOpenHole(e,m.label),fillOverlap(e,m.label),m.label.toLowerCase().includes("cement")&&(d=o))}return o>a&&r.push({top:a,bottom:o,color:X.mud,label:"Drilling Mud"}),{fluidLevels:r,tocMd:d}})(g,x,J,K,0,ne,ie),[g,x,J,K,0,ne,ie]),de=a.useMemo(()=>{const sum=e=>e.reduce((e,t)=>e+(parseFloat(t.volume||"0")||0),0);return[{name:"Cement",value:sum(g),color:X.cement},{name:"Spacers",value:sum(x),color:X.spacer},{name:"Displ.",value:sum(b),color:"#6366F1"}].filter(e=>e.value>0)},[g,x,b]),ce=(null==y?void 0:y.plugForces.bumpForceLbs)||0;return e.jsxs("div",{className:"space-y-6",ref:L,children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 bg-white p-4 rounded-xl shadow",children:[e.jsxs("h2",{className:"text-xl font-bold text-slate-800 flex items-center gap-2",children:[e.jsx(n,{size:18})," Well Analysis Report"]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>T(e=>!e),className:"px-3 py-1 text-sm rounded bg-slate-200 hover:bg-slate-300 flex items-center gap-1",children:[e.jsx(i,{size:14})," ",D?"Hide Volumes":"Show Volumes"]}),e.jsxs("button",{onClick:()=>w(e=>!e),className:"px-3 py-1 text-sm rounded bg-slate-200 hover:bg-slate-300 flex items-center gap-1",children:[e.jsx(r,{size:14})," ",N?"Hide Forces":"Show Forces"]}),e.jsxs("button",{onClick:()=>S(e=>!e),className:"px-3 py-1 text-sm rounded bg-slate-200 hover:bg-slate-300 flex items-center gap-1",children:[e.jsx(o,{size:14})," ",F?"Hide Pressures":"Show Pressures"]}),e.jsxs("button",{onClick:()=>k(e=>!e),className:"px-3 py-1 text-sm rounded bg-slate-200 hover:bg-slate-300 flex items-center gap-1",children:[e.jsx(d,{size:14})," ",C?"Hide Steps":"Show Steps"]}),e.jsxs("button",{onClick:()=>{if(!y)return;const e=new $({unit:"pt",format:"a4"});let t=40;e.setFontSize(16),e.text("Liner Hanger Force Analysis Report",40,t),t+=18,e.setFontSize(10),e.text(`Well: ${y.inputs.casing.md?y.inputs.casing.md.toString():""}  Date: ${(new Date).toISOString().split("T")[0]}`,40,t),t+=12,z(e,{startY:t,head:[["Metric","Value"]],body:[["TOC (MD)",oe.toFixed(0)+" ft"],["Total Cement Volume",y.totalCementVolumeBbl.toFixed(1)+" bbl"],["Excess Cement",y.excessCementBbl.toFixed(1)+" bbl"],["Rig Capacity Margin",y.rigCapacityMarginLbs.toFixed(0)+" lbs"],["Force Margin",y.forceMarginPct.toFixed(1)+" %"],y.plugTravel?["Dart Launch Vol",y.plugTravel.dartLaunchVolumeBbl.toFixed(2)+" bbl"]:null,y.plugTravel?["Latch MD",y.plugTravel.latchMd.toFixed(1)+" ft"]:null,y.plugTravel?["Shear Success",y.plugTravel.shearSuccess?"Yes":"No"]:null,y.plugTravel?["Bump Reached",y.plugTravel.bumpReached?"Yes":"No"]:null].filter(Boolean)}),e.save("liner-hanger-analysis.pdf")},className:"px-4 py-1.5 text-sm rounded bg-blue-600 text-white hover:bg-blue-700 flex items-center gap-1",children:[e.jsx(c,{size:16})," Export PDF"]})]})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow p-4 relative overflow-hidden col-span-2",children:[e.jsxs("h3",{className:"text-sm font-semibold text-slate-700 mb-2 flex items-center gap-2",children:[e.jsx(m,{size:14})," Well Schematic"]}),e.jsxs("div",{className:"w-full h-[640px] relative",children:[e.jsxs("svg",{width:"100%",height:"100%",viewBox:"0 0 520 640",preserveAspectRatio:"xMidYMid meet",children:[e.jsx("rect",{x:ae-ee/2,y:K*E+40,width:ee,height:Q*E+40-(K*E+40),fill:"#d1d5db"}),e.jsx("rect",{x:ae-ee/2,y:Z*E+40,width:ee,height:(K-Z)*E,fill:"#e5e7eb"}),e.jsx("rect",{x:ae-ee/2,y:40,width:ee,height:Z*E,fill:"#f3f4f6"}),D&&re.map(t=>{const s=t.top*E+40,l=t.bottom*E+40,a=t.bottom>K?ee-se:te-se,n=t.bottom>K?ae-ee/2:ae-te/2;return e.jsxs("g",{children:[e.jsx("rect",{x:n,y:s,width:a,height:l-s,fill:t.color,fillOpacity:.55}),e.jsx("rect",{x:ae+se/2,y:s,width:a,height:l-s,fill:t.color,fillOpacity:.55})]},`${t.label}-${t.top}-${t.bottom}`)}),e.jsx("rect",{x:ae-te/2,y:40,width:te,height:K*E,fill:"none",stroke:"#475569",strokeWidth:3}),e.jsx("rect",{x:ae-se/2,y:Z*E+40,width:se,height:(J-Z)*E,fill:"none",stroke:"#64748b",strokeWidth:3}),e.jsx("rect",{x:ae-le/2,y:40,width:le,height:J*E,fill:X.drillPipe}),e.jsx(DepthLabel,{y:40,depth:0,label:"Surface",center:ae,casingWidth:te}),e.jsx(DepthLabel,{y:Z*E+40,depth:Z,label:"Liner Top",center:ae,casingWidth:te}),e.jsx(DepthLabel,{y:K*E+40,depth:K,label:"Casing Shoe",center:ae,casingWidth:te}),e.jsx(DepthLabel,{y:J*E+40,depth:J,label:"Liner Shoe",center:ae,casingWidth:te}),e.jsx(DepthLabel,{y:Q*E+40,depth:Q,label:"TD",center:ae,casingWidth:te}),oe<J&&e.jsx(DepthLabel,{y:oe*E+40,depth:oe,label:"TOC",center:ae,casingWidth:te}),V>0&&e.jsx(DepthLabel,{y:V*E+40,depth:V,label:"LC",center:ae,casingWidth:te}),F&&y&&e.jsxs("g",{children:[e.jsxs("text",{x:ae-ee/2-12,y:Z*E+34,textAnchor:"end",className:"fill-blue-700 text-[10px] font-bold",children:["Pann: ",y.plugForces.hydrostaticPsi.toFixed(0)," psi"]}),e.jsxs("text",{x:ae-ee/2-12,y:J*E+34,textAnchor:"end",className:"fill-green-700 text-[10px] font-bold",children:["Pins: ",(.9*y.plugForces.hydrostaticPsi).toFixed(0)," psi"]})]}),N&&y&&e.jsxs("g",{transform:`translate(380, ${Z*E+20})`,children:[e.jsx("text",{x:0,y:-10,textAnchor:"middle",className:"text-[10px] font-bold fill-slate-700",children:"Net Hanger Force"}),ce>0?e.jsx(u,{size:20,className:"text-red-500"}):e.jsx(p,{size:20,className:"text-green-500"}),e.jsxs("text",{x:0,y:30,textAnchor:"middle",className:"text-xs font-bold "+(ce>0?"fill-red-600":"fill-green-600"),children:[Math.abs(ce).toLocaleString(void 0,{maximumFractionDigits:0})," lbs"]})]})]}),e.jsxs("div",{className:"absolute bottom-4 right-4 bg-white/80 backdrop-blur-sm p-3 rounded shadow text-[10px] space-y-1",children:[e.jsx("div",{className:"font-semibold text-slate-700 text-xs mb-1",children:"Legend"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded bg-amber-600"}),"Cement"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded bg-sky-500"}),"Spacer"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded bg-blue-900"}),"Mud"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded bg-slate-500"}),"Drill Pipe"]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow p-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-slate-700 mb-2 flex items-center gap-2",children:[e.jsx(n,{size:14})," Key Metrics"]}),e.jsx(KeyMetrics,{calculations:y,tocMd:oe})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Fluid Volume Mix"}),de.length?e.jsx("div",{className:"h-48",children:e.jsx(W,{width:"100%",height:"100%",children:e.jsxs(q,{children:[e.jsx(_,{data:de,dataKey:"value",nameKey:"name",innerRadius:35,outerRadius:70,paddingAngle:3,children:de.map(t=>e.jsx(U,{fill:t.color},t.name))}),e.jsx(G,{formatter:e=>e.toFixed(2)+" bbl"}),e.jsx(Y,{})]})})}):e.jsx("p",{className:"text-xs text-slate-500",children:"No fluids."})]}),(null==y?void 0:y.warnings.length)?e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-3",children:[e.jsxs("div",{className:"text-xs font-semibold text-yellow-800 mb-1 flex items-center gap-1",children:[e.jsx(h,{size:12}),"Warnings"]}),e.jsx("ul",{className:"list-disc list-inside space-y-0.5 text-[11px] text-yellow-700",children:y.warnings.map(t=>e.jsx("li",{children:t},t))})]}):null]})]}),C&&y&&e.jsxs("div",{className:"bg-white rounded-xl shadow p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-700 mb-3",children:"Step-by-Step Calculation Snapshot"}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 text-[11px]",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-600 mb-1",children:"Capacities"}),e.jsxs("div",{className:"space-y-0.5",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Liner Int (bbl/ft)"}),e.jsx("span",{children:y.capacities.linerInternal.toFixed(4)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"DP1 Int (bbl/ft)"}),e.jsx("span",{children:y.capacities.dp1Internal.toFixed(4)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Open Hole Ann (bbl/ft)"}),e.jsx("span",{children:y.capacities.openHoleAnnulus.toFixed(4)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Overlap Ann (bbl/ft)"}),e.jsx("span",{children:y.capacities.linerOverlapAnnulus.toFixed(4)})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-600 mb-1",children:"Geometry"}),e.jsxs("div",{className:"space-y-0.5",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Top of Liner"}),e.jsxs("span",{children:[y.geometry.topOfLinerMd.toFixed(0)," ft"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Rat Hole"}),e.jsxs("span",{children:[y.geometry.ratHoleFt.toFixed(0)," ft"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Shoe Track"}),e.jsxs("span",{children:[y.geometry.shoeTrackFt.toFixed(0)," ft"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Annulus to LC"}),e.jsxs("span",{children:[y.geometry.annulusToLcFt.toFixed(0)," ft"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-600 mb-1",children:"Plug Forces"}),e.jsxs("div",{className:"space-y-0.5",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Hydrostatic (psi)"}),e.jsx("span",{children:y.plugForces.hydrostaticPsi.toFixed(0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Plug Force (lbs)"}),e.jsx("span",{children:y.plugForces.plugForceLbs.toFixed(0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Bump Force (lbs)"}),e.jsx("span",{children:y.plugForces.bumpForceLbs.toFixed(0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Safety Factor"}),e.jsx("span",{children:y.plugForces.safetyFactor.toFixed(2)})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-600 mb-1",children:"Displacement"}),e.jsxs("div",{className:"space-y-0.5",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Spacer Vol"}),e.jsxs("span",{children:[y.displacement.spacerVolumeBbl.toFixed(1)," bbl"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Displ. Vol"}),e.jsxs("span",{children:[y.displacement.displacementVolumeBbl.toFixed(1)," bbl"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Displ."}),e.jsxs("span",{children:[y.displacement.totalDisplacementBbl.toFixed(1)," bbl"]})]})]})]}),y.plugTravel&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-600 mb-1",children:"Plug Travel"}),e.jsxs("div",{className:"space-y-0.5",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Launch Vol"}),e.jsxs("span",{children:[y.plugTravel.dartLaunchVolumeBbl.toFixed(2)," bbl"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Latch MD"}),e.jsxs("span",{children:[y.plugTravel.latchMd.toFixed(1)," ft"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Bump Vol"}),e.jsxs("span",{children:[y.plugTravel.bumpVolumeBbl.toFixed(2)," bbl"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Bump Reached"}),e.jsx("span",{children:y.plugTravel.bumpReached?"Yes":"No"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-600 mb-1",children:"Status"}),e.jsxs("div",{className:"space-y-0.5",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Job Status"}),e.jsx("span",{className:"font-semibold capitalize "+(me=y.jobStatus,"success"===me?"text-green-600":"warning"===me?"text-yellow-600":"text-red-600"),children:y.jobStatus})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Warnings"}),e.jsx("span",{children:y.warnings.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"TOC Above Liner Shoe"}),e.jsxs("span",{children:[y.tocAboveLinerShoeFt.toFixed(0)," ft"]})]})]})]})]})]})]});var me};a.memo(({title:s,onClose:l,children:n})=>{const i=a.useCallback(()=>{l()},[l]);return e.jsxs("dialog",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-in","aria-modal":"true","aria-labelledby":"modal-title",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-lg w-full m-4 relative transform transition-all ease-out duration-300 scale-95 opacity-0 animate-in-modal",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center",id:"modal-title",children:[e.jsx(x,{className:"mr-2 text-blue-500",size:22}),s]}),e.jsx("button",{onClick:i,className:"text-gray-400 hover:text-gray-700 transition-colors p-1 rounded-full hover:bg-gray-100","aria-label":"Close modal",children:e.jsx(t,{size:24})})]}),e.jsx("div",{className:"p-6",children:n})]}),e.jsx("style",{children:"\n        @keyframes scaleIn {\n          from { transform: scale(0.95); opacity: 0; }\n          to { transform: scale(1); opacity: 1; }\n        }\n        .animate-in-modal {\n          animation: scaleIn 0.2s forwards;\n        }\n      "})]})}).displayName="Modal";const CalculationStep=({title:t,stepNumber:s,children:l,highlight:a=!1})=>e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md border-l-4 "+(a?"border-blue-500 bg-blue-50":"border-gray-300"),children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 "+(a?"text-blue-700":"text-slate-700"),children:["STEP ",s,": ",t]}),e.jsx("div",{className:"space-y-3",children:l})]}),DataRow$1=({label:t,value:s,unit:l,formula:a,emphasis:n=!1,formatNumber:i})=>e.jsxs("div",{className:"flex flex-col space-y-1 "+(n?"bg-yellow-50 p-2 rounded":""),children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-slate-600 "+(n?"font-medium":""),children:[t,":"]}),e.jsxs("span",{className:"font-medium "+(n?"text-yellow-800 font-bold":""),children:["number"==typeof s&&i?i(s):s," ",l&&e.jsx("span",{className:"text-slate-500",children:l})]})]}),a&&e.jsx("div",{className:"text-xs text-slate-500 font-mono bg-gray-100 p-1 rounded",children:a})]}),DetailedResults=({calculations:t})=>{const{keyCalculations:s}=t,formatNumber=(e,t=2)=>e.toLocaleString(void 0,{minimumFractionDigits:t,maximumFractionDigits:t});return e.jsxs("div",{className:"animate-fade-in space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 text-white p-6 rounded-xl shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Detailed Step-by-Step Calculations"}),e.jsx("p",{className:"text-blue-100",children:"Complete calculation breakdown with all formulas and intermediate results"})]}),e.jsxs(CalculationStep,{title:"Input Parameters",stepNumber:1,children:[e.jsx(DataRow$1,{label:"Hole Diameter",value:s.holeDiameter,unit:"inches",formatNumber:formatNumber}),e.jsx(DataRow$1,{label:"Casing Outer Diameter",value:s.casingOD,unit:"inches",formatNumber:formatNumber}),e.jsx(DataRow$1,{label:"Well Depth",value:s.wellDepth,unit:"ft",formatNumber:formatNumber})]}),e.jsxs(CalculationStep,{title:"Volume Calculations",stepNumber:2,highlight:!0,children:[e.jsx(DataRow$1,{label:"Annular Volume",value:s.annularVolume,unit:"bbl",formula:"π/4 × (D₁² - D₂²) × L ÷ 1029.4",emphasis:!0,formatNumber:formatNumber}),e.jsx(DataRow$1,{label:"Displacement Volume",value:s.displacementVolume,unit:"bbl",formatNumber:formatNumber})]})]})};function cn(...e){return H(E(e))}const SectionCard=({title:t,icon:s,children:l})=>e.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 bg-slate-50 border-b flex items-center gap-2",children:[s,e.jsx("h3",{className:"text-lg font-semibold text-slate-800 tracking-tight",children:t})]}),e.jsx("div",{className:"p-6",children:l})]}),AIInsights=({calculations:t})=>{const s=(l=t,a.useMemo(()=>[{label:"Initial Hookload (lbs)",value:l.keyResults.initialHookload.toFixed(0),color:"text-blue-600"},{label:"Cement Volume (bbls)",value:l.volumes.cementVolume,color:"text-green-600"},{label:"String Stretch (in)",value:l.keyResults.drillStringStretch.toFixed(1),color:"text-amber-600"},{label:"Wait on Cement (min)",value:l.operations.waitOnCement,color:"text-purple-600"}],[l]));var l;return e.jsx("div",{className:"animate-fade-in",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(SectionCard,{title:"AI Insights & Recommendations",icon:e.jsx(f,{className:"text-blue-500",size:20}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(g,{className:"mt-1 text-green-500 flex-shrink-0",size:20}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-800",children:"Calculation Validation"}),e.jsx("p",{className:"text-slate-600 text-sm",children:"All key calculations are within normal operational parameters."})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(b,{className:"mt-1 text-blue-500 flex-shrink-0",size:20}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-800",children:"Operational Recommendations"}),e.jsxs("ul",{className:"text-slate-600 text-sm list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Monitor hookload closely during cementing operations"}),e.jsxs("li",{children:["Maintain circulation rate at ",t.operations.circulationRate," bpm"]}),e.jsxs("li",{children:["Allow ",t.operations.waitOnCement," minutes wait on cement"]})]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(h,{className:"mt-1 text-amber-500 flex-shrink-0",size:20}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-800",children:"Risk Assessment"}),e.jsxs("p",{className:"text-slate-600 text-sm",children:["Safety status: ",t.safetyStatus.hookloadStatus,"; Net force SF: ",t.safetyStatus.netForceStatus]})]})]})]})}),e.jsx(SectionCard,{title:"Key Performance Indicators",children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4",children:s.map(t=>e.jsxs("div",{className:"text-center p-3 md:p-4 bg-slate-50 rounded-lg",children:[e.jsx("div",{className:cn("text-xl md:text-2xl font-bold",t.color),children:t.value}),e.jsx("div",{className:"text-[11px] md:text-sm text-slate-600 leading-tight mt-0.5",children:t.label})]},t.label))})})]})})};class Q extends a.Component{constructor(){super(...arguments),this.state={hasError:!1,error:null},this.handleRetry=()=>{var e,t;this.setState({hasError:!1,error:null}),null==(t=(e=this.props).onRetry)||t.call(e)}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){}getErrorMessage(e){const t=e.message.toLowerCase();return t.includes("division by zero")||t.includes("divide by zero")?"Calculation failed due to division by zero. Check your input parameters, especially diameters and lengths.":t.includes("nan")||t.includes("infinity")?"Calculation resulted in invalid numbers. Verify that all input values are within reasonable ranges.":t.includes("overflow")?"Calculation overflow detected. Your input values may be too large for this calculation.":t.includes("network")||t.includes("fetch")?"Network error occurred while processing calculations. Check your internet connection and try again.":`Calculation error in ${this.props.calculationType}. Please verify your input parameters and try again.`}getSuggestions(e){const t=e.message.toLowerCase(),s=[];return t.includes("division by zero")&&(s.push("Ensure all diameter and length values are greater than zero"),s.push("Check that pipe inner diameter is less than outer diameter")),(t.includes("nan")||t.includes("infinity"))&&(s.push("Verify all numeric inputs are valid numbers"),s.push("Check that fluid densities are within typical ranges (8-20 PPG)"),s.push("Ensure survey data has valid MD, TVD, and inclination values")),t.includes("overflow")&&(s.push("Reduce the magnitude of input values"),s.push("Check for extremely large depth or pressure values")),s.push("Double-check all input parameters for reasonableness"),s.push("Ensure survey data is properly formatted and complete"),s}render(){if(this.state.hasError&&this.state.error){const t=this.getErrorMessage(this.state.error),s=this.getSuggestions(this.state.error);return e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 m-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(j,{className:"h-6 w-6 text-red-500 mr-3 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:[e.jsx(v,{className:"inline h-5 w-5 mr-2"}),this.props.calculationType," Error"]}),e.jsx("p",{className:"text-red-700 mb-4",children:t}),s.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"font-medium text-red-800 mb-2",children:"Suggestions:"}),e.jsx("ul",{className:"list-disc list-inside text-sm text-red-700 space-y-1",children:s.map((t,s)=>e.jsx("li",{children:t},`suggestion-${s}-${t.substring(0,10)}`))})]}),e.jsx("div",{className:"flex gap-3",children:e.jsxs("button",{onClick:this.handleRetry,className:"flex items-center px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm",children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Retry Calculation"]})}),!1]})]})})}return this.props.children}}const PipeInput=({label:t,pipe:s,setPipe:l,pipeData:a,gradeOptions:n,gradeLabel:i,disabled:r=!1,deriveDepths:o})=>{const d="mt-1 block w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 bg-white text-slate-900 disabled:bg-slate-200 disabled:cursor-not-allowed",c="mt-1 block w-full p-2 border border-slate-300 rounded-md bg-slate-200 text-slate-600 cursor-not-allowed text-center",m=t.toLowerCase().replace(/[^a-z0-9]+/g,"-"),u=/(^dp\d|drill\s*pipe)/i.test(t),p=[...new Set(a.map(e=>e.od))],h=a.filter(e=>e.od===s.od),handleGenericChange=e=>{const{name:s,value:a}=e.target;l(e=>{const l={...e,[s]:a};if(o&&/(^dp\d|drill\s*pipe)/i.test(t)){const e=o(l);e&&(l.md=e.md,l.tvd=e.tvd)}return l})};return e.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl shadow-inner "+(r?"opacity-50":""),children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-slate-800",children:t}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 items-end",children:[n&&e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:i||"Grade"}),e.jsx("select",{name:"grade",value:s.grade,onChange:handleGenericChange,className:d,disabled:r,children:n.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"OD (in)"}),e.jsx("select",{name:"od",value:s.od,onChange:e=>{const t=e.target.value,s=a.find(e=>e.od===t);s&&l(e=>({...e,od:t,wt:s.wt,id:s.id,grade:s.grade||e.grade}))},className:d,disabled:r,children:p.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Wt (lb/ft)"}),e.jsx("select",{name:"wt",value:s.wt,onChange:e=>{const t=e.target.value,n=a.find(e=>e.od===s.od&&e.wt===t);n&&l(e=>({...e,wt:t,id:n.id,grade:n.grade||e.grade}))},className:d,disabled:r,children:h.map(t=>e.jsx("option",{value:t.wt,children:t.wt},`${t.wt}-${t.id}`))})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"ID (in)"}),e.jsx("span",{className:c,children:s.id})]})]}),(t.includes("Casing")||t.includes("Liner"))&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 items-end mt-4",children:[e.jsxs("label",{className:"block col-span-2",htmlFor:`${m}-md`,children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Shoe MD (ft)"}),e.jsx("input",{id:`${m}-md`,name:"md",type:"number",value:s.md,onChange:handleGenericChange,className:d,disabled:r})]}),e.jsxs("label",{className:"block col-span-2",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Shoe TVD (ft)"}),e.jsx("span",{className:c,children:s.tvd})]})]}),u&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 items-end mt-4",children:[e.jsxs("label",{className:"block",htmlFor:`${m}-length`,children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Length (ft)"}),e.jsx("input",{id:`${m}-length`,name:"length",type:"number",value:s.length,onChange:handleGenericChange,className:d,disabled:r})]}),e.jsxs("label",{className:"block",htmlFor:`${m}-md-dp`,children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Bottom MD (ft)"}),e.jsx("input",{id:`${m}-md-dp`,name:"md",type:"number",value:s.md,onChange:handleGenericChange,className:d,disabled:r})]}),e.jsxs("label",{className:"block col-span-2",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Bottom TVD (ft)"}),e.jsx("span",{className:c,children:s.tvd})]})]})]})},CalculationCard=({title:t,children:s,className:l})=>e.jsxs("div",{className:`bg-white p-4 rounded-xl shadow-md ${l||""}`,children:[e.jsx("h3",{className:"text-base font-semibold text-slate-800 mb-3 border-b pb-2",children:t}),e.jsx("div",{className:"space-y-2 text-sm",children:s})]}),DataRow=({label:t,value:s,unit:l,className:a})=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-slate-600",children:[t,":"]}),e.jsxs("span",{className:`font-semibold text-slate-800 bg-slate-100 px-2 py-0.5 rounded ${a||""}`,children:["number"==typeof s?s.toLocaleString(void 0,{maximumFractionDigits:2}):s," "," ",e.jsx("span",{className:"text-xs text-slate-500",children:l})]})]}),bblPerFt=(e,t=0)=>(Math.pow(e,2)-Math.pow(t,2))/1029.4,bblPerFtInternal=e=>bblPerFt(e,0),bblPerFtAnnular=(e,t)=>bblPerFt(e,t),pipeSteelAreaIn2=(e,t)=>Math.PI/4*(Math.pow(e,2)-Math.pow(t,2));function getAnnulusSegmentConfig(e,t,s){return s>e.casing.md?{capacity:t.openHoleAnnulus,label:"Cement (Open Hole Annulus)",top:Math.max(e.casing.md,e.landingCollarMd)}:{capacity:t.linerOverlapAnnulus,label:"Cement (Liner/Casing Overlap)",top:e.landingCollarMd}}function distributeCementBottomUp(e,t,s){const l={segments:[],remainingCement:e.cements.reduce((e,t)=>e+t.volumeBbl,0),currentMd:e.totalDepthMd};!function(e,t,s,l){var a;if(s.ratHoleFt<=0||l.remainingCement<=0)return;const n=s.ratHoleFt*t.openHoleAnnulus,i=Math.min(l.remainingCement,n),r=i/t.openHoleAnnulus,o=l.currentMd-r,d=l.currentMd;l.segments.push({label:"Cement (Rat Hole)",topMd:o,bottomMd:d,topTvd:e.findTvdFromMd(o),bottomTvd:e.findTvdFromMd(d),ppg:(null==(a=e.cements[0])?void 0:a.ppg)||0,volumeBbl:i}),l.remainingCement-=i,l.currentMd=o}(e,t,s,l),function(e,t,s,l){var a;if(s.shoeTrackFt<=0||l.remainingCement<=0)return;const n=s.shoeTrackFt*t.linerInternal,i=Math.min(l.remainingCement,n),r=i/t.linerInternal,o=e.liner.md-r,d=e.liner.md;l.segments.push({label:"Cement (Shoe Track)",topMd:o,bottomMd:d,topTvd:e.findTvdFromMd(o),bottomTvd:e.findTvdFromMd(d),ppg:(null==(a=e.cements[0])?void 0:a.ppg)||0,volumeBbl:i}),l.remainingCement-=i,l.currentMd=o}(e,t,s,l),function(e,t,s,l){var a;if(s.annulusToLcFt<=0||l.remainingCement<=0)return;let n=Math.max(l.currentMd,e.liner.md);for(;l.remainingCement>0&&n>e.landingCollarMd;){const s=getAnnulusSegmentConfig(e,t,n),i=(n-s.top)*s.capacity,r=Math.min(l.remainingCement,i),o=n-r/s.capacity,d=n;if(!(r>0))break;l.segments.push({label:s.label,topMd:o,bottomMd:d,topTvd:e.findTvdFromMd(o),bottomTvd:e.findTvdFromMd(d),ppg:(null==(a=e.cements[0])?void 0:a.ppg)||0,volumeBbl:r}),l.remainingCement-=r,n=o}l.currentMd=n}(e,t,s,l);const a=l.currentMd,n=a<=e.landingCollarMd+1e-6,i=Math.max(0,l.remainingCement);return{cementSegments:l.segments,excessCement:i,topOfCementMd:a,reachedLandingCollar:n}}function calculatePlugForces(e,t){const{holeOverlap:s,setdownForceLbs:l}=e,a=e.liner.id||s.openHoleId,n=(i=a,Math.PI/4*Math.pow(i,2));var i;let r=0;for(const m of t.cementSegments){const t=Number(e.findTvdFromMd(m.topMd)),s=Number(e.findTvdFromMd(m.bottomMd)),l=Math.abs(s-t);l>0&&(r+=.052*m.ppg*l)}const o=r*n;const d=(s.shearStrengthPsi||500)*(Math.PI*a*12),c=o+l;return{plugAreaSqIn:n,hydrostaticPsi:r,plugForceLbs:o,shearCapacityLbs:d,bumpForceLbs:c,bumpMarginLbs:d-c,safetyFactor:c>0?d/c:0}}function calculateEnhancedCementingJob(e){try{const{casing:t,liner:s,dp1:l,dp2:a,dpConfig:n,mud:i,spacers:r,cements:o,displacements:d,holeOverlap:c,landingCollarMd:m,totalDepthMd:u,setdownForceLbs:p,hookloadSF:h,forceSF:x,findTvdFromMd:g,dartLaunchVolumeBbl:b}=e,f=function(e){const{casing:t,liner:s,dp1:l,dp2:a,dpConfig:n,mud:i,spacers:r,cements:o,displacements:d,dartLaunchVolumeBbl:c,holeOverlap:m,landingCollarMd:u,totalDepthMd:p,setdownForceLbs:h,hookloadSF:x,forceSF:g,findTvdFromMd:b}=e,f={id:parseFloat(t.id||"0"),od:parseFloat(t.od||"0"),md:parseFloat(t.md||"0"),tvd:parseFloat(t.tvd||"0")},j={id:parseFloat(s.id||"0"),od:parseFloat(s.od||"0"),md:parseFloat(s.md||"0"),tvd:parseFloat(s.tvd||"0"),length:parseFloat(s.md||"0")-(f.md-parseFloat(m.linerOverlap||"0"))},v={id:parseFloat(l.id||"0"),od:parseFloat(l.od||"0"),length:parseFloat(l.length||"0")},y={id:parseFloat(a.id||"0"),od:parseFloat(a.od||"0"),length:"single"===n?0:parseFloat(a.length||"0")};if(u>=j.md)throw new Error("Landing Collar MD must be shallower than liner shoe MD");return{casing:f,liner:j,dp1:v,dp2:y,dpConfig:n,mud:{ppg:parseFloat(i.ppg||"0")},spacers:r.map(e=>({label:e.label,volumeBbl:parseFloat(e.volume||"0"),ppg:parseFloat(e.ppg||"0")})),cements:o.map(e=>({label:e.label,volumeBbl:parseFloat(e.volume||"0"),ppg:parseFloat(e.ppg||"0")})),displacements:d.map(e=>({label:e.label,volumeBbl:parseFloat(e.volume||"0"),ppg:parseFloat(e.ppg||"0")})),dartLaunchVolumeBbl:parseFloat(String(c||0)),holeOverlap:(()=>{const e={openHoleId:parseFloat(m.openHoleId||"0"),linerOverlapFt:parseFloat(m.linerOverlap||"0"),shoeTrackLengthFt:parseFloat(m.shoeTrackLength||"0"),cementThickeningTimeMin:parseFloat(m.cementThickeningTime||"0"),rigCapacityLbs:parseFloat(m.rigCapacity||"0")};return m.shearStrengthPsi&&(e.shearStrengthPsi=parseFloat(m.shearStrengthPsi)),m.pumpStrokeToleranceBbl&&(e.pumpStrokeToleranceBbl=parseFloat(m.pumpStrokeToleranceBbl)),e})(),landingCollarMd:u,totalDepthMd:p,setdownForceLbs:h,hookloadSF:x,forceSF:g,findTvdFromMd:b}}({casing:t,liner:s,dp1:l,dp2:a,dpConfig:n,mud:i,spacers:r,cements:o,displacements:d,dartLaunchVolumeBbl:b,holeOverlap:c,landingCollarMd:m,totalDepthMd:u,setdownForceLbs:p,hookloadSF:h,forceSF:x,findTvdFromMd:g}),j=function(e){return{dp1Internal:bblPerFtInternal(e.dp1.id),dp2Internal:bblPerFtInternal(e.dp2.id),linerInternal:bblPerFtInternal(e.liner.id),openHoleAnnulus:bblPerFtAnnular(e.holeOverlap.openHoleId,e.liner.od),linerOverlapAnnulus:bblPerFtAnnular(e.casing.id,e.liner.od),dpAnnulus:bblPerFtAnnular(e.casing.id,Math.max(e.dp1.od,e.dp2.od))}}(f),v=function(e){const t=e.casing.md-e.holeOverlap.linerOverlapFt;return{ratHoleFt:Math.max(e.totalDepthMd-e.liner.md,0),shoeTrackFt:e.holeOverlap.shoeTrackLengthFt,annulusToLcFt:Math.max(e.liner.md-e.holeOverlap.shoeTrackLengthFt-e.landingCollarMd,0),linerLengthFt:e.liner.md-t,topOfLinerMd:t}}(f),y=distributeCementBottomUp(f,j,v),N=calculatePlugForces(f,y),w=function(e,t){const{displacements:s,spacers:l}=e,a=l.reduce((e,t)=>e+t.volumeBbl,0),n=s.reduce((e,t)=>e+t.volumeBbl,0),i=a+n,r=e.dp1.length*t.dp1Internal+e.dp2.length*t.dp2Internal,o=pipeSteelAreaIn2(e.dp1.od,e.dp1.id),d=pipeSteelAreaIn2(e.dp2.od,e.dp2.id),c=12*o*.283*e.dp1.length+12*d*.283*e.dp2.length,m=[];l.forEach(e=>m.push({volumeBbl:e.volumeBbl,ppg:e.ppg})),s.forEach(e=>m.push({volumeBbl:e.volumeBbl,ppg:e.ppg}));const u=m.reduce((e,t)=>e+t.volumeBbl,0),p=Math.max(r-u,0);p>0&&m.push({volumeBbl:p,ppg:e.mud.ppg});const h=m.reduce((e,t)=>e+42*t.volumeBbl*t.ppg,0),x=42*(e.dp1.length*bblPerFtInternal(e.dp1.od)+e.dp2.length*bblPerFtInternal(e.dp2.od))*e.mud.ppg;return{spacerVolumeBbl:a,displacementVolumeBbl:n,totalDisplacementBbl:i,pipeStringVolumeBbl:r,hookloadLbs:c+h-x,pipeWeightLbs:c,fluidWeightLbs:h,buoyancyLbs:x}}(f,j),F=function(e,t,s,l){const{dartLaunchVolumeBbl:a,holeOverlap:n,landingCollarMd:i}=e,r=e.dp1.length*t.dp1Internal+e.dp2.length*t.dp2Internal-(n.pumpStrokeToleranceBbl??.5),o=s.topOfLinerMd,d=a>=r,c=(i-s.topOfLinerMd)*t.linerInternal-(n.pumpStrokeToleranceBbl??.5),m=e.displacements.reduce((e,t)=>e+t.volumeBbl,0);return{dartLaunchVolumeBbl:a,latchMd:o,shearSuccess:d,bumpVolumeBbl:m,bumpReached:m>=c,bumpForceLbs:l.bumpForceLbs,bumpSafetyFactor:l.safetyFactor}}(f,j,v,N);return function(e,t,s,l,a,n,i){const r=l.topOfCementMd,o=Number(e.findTvdFromMd(r)),d=e.liner.md-r,c=e.cements.reduce((e,t)=>e+t.volumeBbl,0),m=c-l.excessCement,u=m/c*100,p=n.hookloadLbs*e.hookloadSF,h=e.holeOverlap.rigCapacityLbs-p,x=a.bumpMarginLbs/a.shearCapacityLbs*100,g=e.holeOverlap.rigCapacityLbs-a.bumpForceLbs;let b="success";const f=[];return h<0&&(b="failure",f.push(`Rig capacity exceeded by ${Math.abs(h).toFixed(0)} lbs`)),g<0&&(b="failure",f.push(`Dynamic bump force exceeds rig capacity by ${Math.abs(g).toFixed(0)} lbs`)),l.reachedLandingCollar||(b="failure",f.push("Cement did not reach landing collar")),r<e.landingCollarMd&&l.excessCement>0&&(b="warning",f.push(`TOC unexpectedly above Landing Collar due to excess cement (${l.excessCement.toFixed(1)} bbl excess)`)),x<20&&"failure"!==b&&(b="warning",f.push(`Low safety margin on plug forces (${x.toFixed(1)}%)`)),l.excessCement>.1*c&&"failure"!==b&&(b="warning",f.push(`Significant cement excess (${(l.excessCement/c*100).toFixed(1)}%)`)),h<.1*e.holeOverlap.rigCapacityLbs&&h>=0&&"failure"!==b&&(b="warning",f.push(`Low rig capacity margin (${h.toFixed(0)} lbs remaining)`)),{jobStatus:b,warnings:f,tocMd:r,tocTvd:o,tocAboveLinerShoeFt:d,cementSegments:l.cementSegments,totalCementVolumeBbl:c,placedCementVolumeBbl:m,excessCementBbl:l.excessCement,cementUtilization:u,plugForces:a,plugTravel:i,displacement:n,rigCapacityMarginLbs:h,factoredHookloadLbs:p,forceMarginPct:x,geometry:s,capacities:t,inputs:e,calculationTimestamp:(new Date).toISOString(),prdVersion:"1.0",calculationMethod:"bottom-up-cement-distribution"}}(f,j,v,y,N,w,F)}catch(t){throw new Error(`Enhanced calculation failed: ${t instanceof Error?t.message:"Unknown error"}`)}}const ee={},num=e=>parseFloat(e||"0")||0;function basePipe(e){return{od:num(e.od),id:num(e.id),wt:num(e.wt),length:num(e.length),md:num(e.md),tvd:num(e.tvd),grade:e.grade||""}}async function runBackendCalculation(e){const t=function(e){const{casing:t,liner:s,dp1:l,dp2:a,dpConfig:n,mud:i,holeOverlap:r}=e;return{casing:basePipe(t),liner:basePipe(s),dp1:basePipe(l),dp2:"dual"===n?basePipe(a):void 0,mud:{ppg:num(i.ppg)},holeOverlap:{openHoleId:num(r.openHoleId),linerOverlap:num(r.linerOverlap),shoeTrackLength:num(r.shoeTrackLength)}}}(e),s=await async function(e){const t=(null==ee?void 0:ee.VITE_BACKEND_URL)||"http://localhost:8001",s=await fetch(`${t.replace(/\/$/,"")}/calculate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),signal:null});if(!s.ok){const e=await s.text();throw new Error(`Backend error ${s.status}: ${e}`)}return s.json()}(t);return function(e,t){return{keyCalculations:{},cementForceCalcs:{table:[]},jobSummary:{wellName:t.wellName,date:t.jobDate,linerTopDepth:0,linerShoeDepth:0,linerLength:0},keyResults:{initialHookload:0,hookloadWithSF:0,postCementHookload:0,drillStringStretch:0,netForceOnLinerHanger:0,netForceWithSF:0,requiredCementVolume:e.cementVolume,uTubePressureDifferential:0,criticalPumpRate:0},safetyStatus:{hookloadStatus:"OK",netForceStatus:"N/A",stretchStatus:"0 in"},buoyancyAndWeight:{mudBuoyancyFactor:0,spacerBuoyancyFactor:0,cementBuoyancyFactor:0,linerAirWeight:0,linerBuoyedWeight:0,dpAirWeight:0,dpBuoyedWeight:0},volumeCalcs:{linerCapacity:0,dpCapacity:0,annulusVolume:e.annulusAreaFt2,totalCementRequired:e.cementVolume,stringDisplacement:0},hydrostaticPressure:{mudPressureAtLinerTop:0,mudPressureAtLinerShoe:0,cementPressureAtLinerTop:0,cementPressureAtLinerShoe:0},hookloadCalcs:{initialHookload:0,hookloadWithSF:0,postCementHookload:0},stretchCalcs:{setdownForce:0,totalLoadOnDrillString:0,drillStringCrossSection:0,stretchDueToLoad:0,stretchInFeet:0},forceAnalysis:{downwardForceLinerWeight:0,downwardForceSetdown:0,upwardForceCementBuoyancy:0,netDownwardForce:0,netForceWithSF:0},uTubeEffect:{pressureDiffAtSurface:0,criticalPumpRate:0},volumes:{cementVolume:e.cementVolume,displacementVolume:0,plugDrop:0,totalWellVolume:0,linerDisplacementVolume:0,surfaceToShoe:0},operations:{waitOnCement:0,cementTravelTime:0,circulationRate:0},keyVolumes:[],cementForces:null,plots:t.previousPlots||[],torqueDragResult:t.previousTorqueDrag||null,torqueDragRotate:t.previousTorqueDrag||null,torqueDragNoRotate:null}}(s,{wellName:e.wellName,jobDate:e.jobDate,previousPlots:e.previousPlots||[],previousTorqueDrag:e.previousTorqueDrag??null})}const parseSurveyData=e=>e.map(e=>({md:parseFloat(e[0]||"0"),tvd:parseFloat(e[1]||"0")})).filter(e=>!isNaN(e.md)&&!isNaN(e.tvd)).sort((e,t)=>e.md-t.md),interpolateTvd=(e,t,s)=>{if(e.md===t.md)return e.tvd;const l=(t.tvd-e.tvd)/(t.md-e.md);return e.tvd+l*(s-e.md)},extrapolateTvdFromEnd=(e,t)=>{var s;const l=e.slice(-2);if(2===l.length){const e=l[0],s=l[1];if(e&&s){const l=(s.tvd-e.tvd)/(s.md-e.md);return s.tvd+l*(t-s.md)}}return(null==(s=e[e.length-1])?void 0:s.tvd)??t},extrapolateTvdFromStart=(e,t)=>{var s;const l=e.slice(0,2);if(2===l.length){const e=l[0],s=l[1];if(e&&s){const l=(s.tvd-e.tvd)/(s.md-e.md);return e.tvd+l*(t-e.md)}}return(null==(s=e[0])?void 0:s.tvd)??t},te={BASE_URL:"/liner-cementing-job-calculator/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};function splitLine(e){return e.includes(",")?e.split(",").map(e=>e.trim()):e.trim().split(/\s+/)}function normalizeHeader(e){return e.trim().toLowerCase().replace(/[^a-z0-9]+/g,"")}function parseCSV(e){const t=e.split(/\r?\n/).filter(e=>e.trim().length>0);if(0===t.length)return[];const s=splitLine(t[0]||"").map(normalizeHeader),l=[];for(let a=1;a<t.length;a++){const e=splitLine(t[a]||"");if(0===e.length)continue;const n={};for(let t=0;t<s.length&&t<e.length;t++){const l=s[t],a=e[t];l&&a&&(n[l]=a.replace(/(^"|"$)/g,""))}l.push(n)}return l}async function fetchText(e){try{const s=(t=e,"/liner-cementing-job-calculator/".replace(/\/?$/,"/")+t.replace(/^\//,"")),l=(import.meta,"undefined"!=typeof window&&window.__BUILD_ID__?(null==te?void 0:te.VITE_BUILD_ID)||(null==te?void 0:te.VITE_APP_VERSION)||window.__BUILD_ID__:Date.now().toString()),a=s+(s.includes("?")?"&":"?")+"v="+encodeURIComponent(String(l)),n=await fetch(a,{cache:"no-store"});if(!n.ok)return null;return await n.text()}catch{return null}var t}async function loadCasingLinerTable(e){const t=await fetchText("tables/casing_liner_standard_table.csv");if(!t)return e;const s=parseCSV(t),l=[];for(const a of s){const e=a.od,t=a.weight||a.wt,s=a.id;e&&t&&s&&l.push({od:e.trim(),wt:t.trim(),id:s.trim()})}return l.length?l:e}async function loadDrillPipeMeasures(e){const t=await fetchText("tables/drill_pipes_standard_table_measures.csv");if(!t)return e;const s=parseCSV(t),l=[];for(const a of s){const e=a.od,t=a.weight||a.wt,s=a.id;e&&t&&s&&l.push({od:e.trim(),wt:t.trim(),id:s.trim()})}return l.length?l:e}let se=[{od:"3.500",id:"2.992",wt:"9.50"},{od:"4.000",id:"3.476",wt:"11.85"},{od:"4.500",id:"3.826",wt:"16.60"},{od:"4.500",id:"3.670",wt:"20.00"},{od:"5.000",id:"4.276",wt:"19.50"},{od:"5.000",id:"4.156",wt:"25.60"},{od:"5.500",id:"4.800",wt:"19.50"},{od:"5.500",id:"4.670",wt:"24.70"},{od:"6.625",id:"5.965",wt:"25.20"},{od:"6.625",id:"5.875",wt:"28.20"}],le=[{od:"7.000",wt:"23.00",id:"6.276"},{od:"7.000",wt:"26.00",id:"6.184"},{od:"7.000",wt:"29.00",id:"6.094"},{od:"8.625",wt:"24.00",id:"7.921"},{od:"8.625",wt:"28.00",id:"7.825"},{od:"8.625",wt:"32.00",id:"7.725"},{od:"9.625",wt:"36.00",id:"8.921"},{od:"9.625",wt:"40.00",id:"8.799"},{od:"9.625",wt:"43.50",id:"8.681"},{od:"10.750",wt:"45.50",id:"9.950"},{od:"10.750",wt:"51.00",id:"9.760"}],ae=["E-75","X-95","G-105","S-135","V-150","L-80","P-110"];const App=()=>{const[t,s]=a.useState("well-config"),[l,n]=a.useState("dashboard"),[i,r]=a.useState("dual"),[o,d]=a.useState("Well-123"),[c,m]=a.useState((new Date).toISOString().split("T")[0]),[u,p]=a.useState("20000"),[x,g]=a.useState("1.25"),[j,y]=a.useState("1.5"),[I,B]=a.useState("0"),[H,E]=a.useState("500"),[W,q]=a.useState("0.5"),[_,U]=a.useState({od:"9.625",id:"8.799",wt:"40.00",md:"5100",tvd:"5099",grade:"P-110"}),[G,Y]=a.useState({od:"7.000",id:"6.184",wt:"29.00",md:"9280",tvd:"8463",grade:"L-80"}),[K,J]=a.useState({grade:"G-105",od:"5.500",id:"4.67",wt:"24.70",length:"5480",md:"5820",tvd:"5819"}),[X,ee]=a.useState({grade:"S-135",od:"5.000",id:"4.276",wt:"19.50",length:"3800",md:"0",tvd:"0"}),[te,ne]=a.useState(le),[ie,re]=a.useState(se),[oe,de]=a.useState(ae),[ce,me]=a.useState({openHoleId:"8.5",linerOverlap:"300",shoeTrackLength:"221",cementThickeningTime:"200",rigCapacity:"500000",casingFrictionFactor:"0.25",openHoleFrictionFactor:"0.30"}),[ue,pe]=a.useState({md:"9057",tvd:""}),[he,xe]=a.useState({md:"9283",tvd:""}),[ge,be]=a.useState({ppg:"13.00"}),[fe,je]=a.useState([{label:"Spacer 1",volume:"40",ppg:"12.00"},{label:"Spacer 2",volume:"30",ppg:"8.40"},{label:"Spacer 3",volume:"40",ppg:"12.00"}]),[ve,ye]=a.useState([{label:"Lead Cement",volume:"50",ppg:"15.80"},{label:"Tail Cement",volume:"80",ppg:"16.70"}]),[Ne,we]=a.useState([{label:"Liner Displ. 1",volume:"22",ppg:"12.00"},{label:"Liner Displ. 2",volume:"100",ppg:"8.30"},{label:"DP Displ.",volume:"120",ppg:"11.00"}]),[Fe,Se]=a.useState(3),[Ce,ke]=a.useState(2),[De,Te]=a.useState(3),[Le,Me]=a.useState([]),[Pe,Ae]=a.useState(""),[Oe,Re]=a.useState(null),[Ie,Be]=a.useState(!1),[Ve,He]=a.useState(!1),[Ee,$e]=a.useState(!1),[ze,We]=a.useState(""),[qe,_e]=a.useState(!1),[Ue,Ge]=a.useState(""),[Ye,Ke]=a.useState(""),[Je,Ze]=a.useState(!1),[Xe,Qe]=a.useState("20000"),[et,tt]=a.useState(!1),[st,lt]=a.useState(null),[at,nt]=a.useState(null),[it,rt]=a.useState(!1),[ot,dt]=a.useState(null),ct=a.useCallback(e=>((e,t)=>{const s="number"==typeof e?e:parseFloat(e||"0");if(t.length<2||isNaN(s))return s>0?s.toFixed(2):"0";const l=parseSurveyData(t),a=l.find(e=>e.md===s);if(a)return a.tvd.toFixed(2);const n=l.filter(e=>e.md<=s).pop(),i=l.find(e=>e.md>=s);return n&&i?interpolateTvd(n,i,s).toFixed(2):n?extrapolateTvdFromEnd(l,s).toFixed(2):i?extrapolateTvdFromStart(l,s).toFixed(2):s.toFixed(2)})(e,Le),[Le]);a.useEffect(()=>{(async()=>{try{const[e,t]=await Promise.all([loadCasingLinerTable(le),loadDrillPipeMeasures(se)]);ne(e),re(t),de(ae)}catch{}})()},[]);const mt=N.useMemo(()=>{const e=parseFloat(_.id||"0");return[...new Set(te.map(e=>e.od))].filter(t=>parseFloat(t)<e)},[te,_.id]);a.useEffect(()=>{if(G.od&&!mt.includes(G.od)){const e=mt[0]||"";if(e){const t=te.find(t=>t.od===e);t&&Y(e=>({...e,od:t.od,wt:t.wt,id:t.id}))}}},[mt]);const ut=N.useMemo(()=>{const e=parseFloat(G.id||"0");return[...new Set(ie.map(e=>e.od))].filter(t=>parseFloat(t)<e)},[ie,G.id]);a.useEffect(()=>{if(K.od&&!ut.includes(K.od)){const e=ut[0]||"";if(e){const t=ie.find(t=>t.od===e);t&&J(e=>({...e,od:t.od,wt:t.wt,id:t.id}))}}if(X.od&&!ut.includes(X.od)){const e=ut[0]||"";if(e){const t=ie.find(t=>t.od===e);t&&ee(e=>({...e,od:t.od,wt:t.wt,id:t.id}))}}},[ut]);const pt=N.useMemo(()=>te,[te]),ht=N.useMemo(()=>te.filter(e=>mt.includes(e.od)),[te,mt]),xt=N.useMemo(()=>ie.filter(e=>ut.includes(e.od)),[ie,ut]);a.useEffect(()=>{je(e=>Array.from({length:Fe},(t,s)=>e[s]||{label:`Spacer ${s+1}`,volume:"100",ppg:""}))},[Fe]),a.useEffect(()=>{ye(e=>Array.from({length:Ce},(t,s)=>e[s]||{label:0===s?"Lead Cement":`Tail Cement ${s}`,volume:"100",ppg:""}))},[Ce]),a.useEffect(()=>{we(e=>Array.from({length:De},(t,s)=>e[s]||{label:`Displ. Fluid ${s+1}`,volume:"100",ppg:""}))},[De]),a.useEffect(()=>{U(e=>({...e,tvd:ct(e.md)})),Y(e=>({...e,tvd:ct(e.md)})),J(e=>({...e,tvd:ct(e.md)})),ee(e=>({...e,tvd:ct(e.md)})),pe(e=>({...e,tvd:ct(e.md)})),xe(e=>({...e,tvd:ct(e.md)}))},[_.md,G.md,K.md,X.md,ue.md,he.md,Le,ct]);const parsePipe=(e,t,s=!1)=>{const l=s&&"single"===(t||i)?"0":e.length;return{grade:e.grade,od:parseFloat(e.od||"0"),id:parseFloat(e.id||"0"),wt:parseFloat(e.wt||"0"),length:parseFloat(l||"0"),md:parseFloat(e.md||"0"),tvd:parseFloat(e.tvd||"0")}},gt=a.useCallback(async()=>{He(!0);try{if(Ie){const e=await runBackendCalculation({casing:_,liner:G,dp1:K,dp2:X,dpConfig:i,mud:ge,holeOverlap:ce,wellName:o,jobDate:c||"",previousPlots:(null==Oe?void 0:Oe.plots)||[],previousTorqueDrag:(null==Oe?void 0:Oe.torqueDragResult)||null});Re(e)}else{const e=function(e,t,s,l,a){const n={step1:{title:"Input Normalization & Validation",details:{casingId:e.inputs.casing.id,casingOd:e.inputs.casing.od,linerLength:e.inputs.liner.length,openHoleId:e.inputs.holeOverlap.openHoleId,landingCollarMd:e.inputs.landingCollarMd,totalDepthMd:e.inputs.totalDepthMd}},step2:{title:"Pipe Capacity Calculations",details:{linerCapacity:e.capacities.linerInternal,dp1Capacity:e.capacities.dp1Internal,dp2Capacity:e.capacities.dp2Internal,openHoleAnnulus:e.capacities.openHoleAnnulus,linerOverlapAnnulus:e.capacities.linerOverlapAnnulus}},step3:{title:"Geometric Length Definitions",details:{topOfLinerMd:e.geometry.topOfLinerMd,ratHoleFt:e.geometry.ratHoleFt,shoeTrackFt:e.geometry.shoeTrackFt,annulusToLcFt:e.geometry.annulusToLcFt,linerLengthFt:e.geometry.linerLengthFt}},step4:{title:"Bottom-Up Cement Distribution",details:{cementSegments:e.cementSegments.map(e=>({label:e.label,topMd:e.topMd,bottomMd:e.bottomMd,volumeBbl:e.volumeBbl,ppg:e.ppg})),topOfCementMd:e.tocMd,topOfCementTvd:e.tocTvd,cementUtilization:e.cementUtilization,excessCement:e.excessCementBbl}},step5:{title:"Plug Force & Shear Calculations",details:{plugAreaSqIn:e.plugForces.plugAreaSqIn,hydrostaticPsi:e.plugForces.hydrostaticPsi,plugForceLbs:e.plugForces.plugForceLbs,shearCapacityLbs:e.plugForces.shearCapacityLbs,bumpForceLbs:e.plugForces.bumpForceLbs,bumpMarginLbs:e.plugForces.bumpMarginLbs,safetyFactor:e.plugForces.safetyFactor}},step5b:{title:"Plug Travel Sequence",details:{dartLaunchVolumeBbl:e.plugTravel.dartLaunchVolumeBbl,latchMd:e.plugTravel.latchMd,shearSuccess:e.plugTravel.shearSuccess,bumpVolumeBbl:e.plugTravel.bumpVolumeBbl,bumpReached:e.plugTravel.bumpReached,bumpForceLbs:e.plugTravel.bumpForceLbs,bumpSafetyFactor:e.plugTravel.bumpSafetyFactor}},step6:{title:"Displacement & Hookload Calculations",details:{spacerVolumeBbl:e.displacement.spacerVolumeBbl,displacementVolumeBbl:e.displacement.displacementVolumeBbl,totalDisplacementBbl:e.displacement.totalDisplacementBbl,pipeStringVolumeBbl:e.displacement.pipeStringVolumeBbl,hookloadLbs:e.displacement.hookloadLbs,pipeWeightLbs:e.displacement.pipeWeightLbs,fluidWeightLbs:e.displacement.fluidWeightLbs,buoyancyLbs:e.displacement.buoyancyLbs}},step7:{title:"Safety & Margin Analysis",details:{jobStatus:e.jobStatus,warnings:e.warnings,rigCapacityMarginLbs:e.rigCapacityMarginLbs,forceMarginPct:e.forceMarginPct,tocAboveLinerShoeFt:e.tocAboveLinerShoeFt}}},i={wellName:t,date:s,linerTopDepth:e.geometry.topOfLinerMd,linerShoeDepth:e.inputs.liner.md,linerLength:e.geometry.linerLengthFt},r={initialHookload:e.displacement.hookloadLbs,hookloadWithSF:e.displacement.hookloadLbs*e.inputs.hookloadSF,postCementHookload:e.displacement.hookloadLbs+e.plugForces.plugForceLbs,drillStringStretch:e.displacement.hookloadLbs/1e3*.1,netForceOnLinerHanger:e.plugForces.bumpForceLbs,netForceWithSF:e.plugForces.bumpForceLbs*e.inputs.forceSF,requiredCementVolume:e.totalCementVolumeBbl,uTubePressureDifferential:.1*e.plugForces.hydrostaticPsi,criticalPumpRate:5},o={hookloadStatus:e.rigCapacityMarginLbs>0?"OK":"Exceeds Rig Capacity",netForceStatus:`${e.forceMarginPct.toFixed(1)}% margin`,stretchStatus:`${r.drillStringStretch.toFixed(2)} in`},d={mudBuoyancyFactor:.8,spacerBuoyancyFactor:.75,cementBuoyancyFactor:.7,linerAirWeight:e.displacement.pipeWeightLbs,linerBuoyedWeight:e.displacement.pipeWeightLbs-e.displacement.buoyancyLbs,dpAirWeight:.7*e.displacement.pipeWeightLbs,dpBuoyedWeight:.7*e.displacement.pipeWeightLbs-.7*e.displacement.buoyancyLbs},c={linerCapacity:e.capacities.linerInternal,dpCapacity:e.capacities.dp1Internal,annulusVolume:(e.geometry.ratHoleFt+e.geometry.annulusToLcFt)*e.capacities.openHoleAnnulus,totalCementRequired:e.totalCementVolumeBbl,stringDisplacement:e.displacement.totalDisplacementBbl},m={mudPressureAtLinerTop:.052*e.inputs.mud.ppg*e.inputs.casing.tvd,mudPressureAtLinerShoe:.052*e.inputs.mud.ppg*e.inputs.liner.tvd,cementPressureAtLinerTop:.8*e.plugForces.hydrostaticPsi,cementPressureAtLinerShoe:e.plugForces.hydrostaticPsi},u={initialHookload:r.initialHookload,hookloadWithSF:r.hookloadWithSF,postCementHookload:r.postCementHookload},p={setdownForce:e.inputs.setdownForceLbs,totalLoadOnDrillString:e.displacement.hookloadLbs,drillStringCrossSection:Math.PI*Math.pow(e.inputs.dp1.od,2)/4,stretchDueToLoad:r.drillStringStretch,stretchInFeet:r.drillStringStretch/12},h={downwardForceLinerWeight:d.linerBuoyedWeight,downwardForceSetdown:e.inputs.setdownForceLbs,upwardForceCementBuoyancy:e.displacement.buoyancyLbs,netDownwardForce:r.netForceOnLinerHanger,netForceWithSF:r.netForceWithSF},x={pressureDiffAtSurface:r.uTubePressureDifferential,criticalPumpRate:r.criticalPumpRate},g={cementVolume:e.totalCementVolumeBbl,displacementVolume:e.displacement.displacementVolumeBbl,plugDrop:e.displacement.spacerVolumeBbl,totalWellVolume:c.annulusVolume+e.inputs.liner.length*e.capacities.linerInternal,linerDisplacementVolume:e.inputs.liner.length*e.capacities.linerInternal,surfaceToShoe:e.inputs.casing.md*e.capacities.linerInternal},b={waitOnCement:e.inputs.holeOverlap.cementThickeningTimeMin,cementTravelTime:e.totalCementVolumeBbl/8,circulationRate:8};return{keyCalculations:n,cementForceCalcs:{table:e.cementSegments.map(t=>({fluid:t.label,annulusPpg:t.ppg,insidePpg:e.inputs.mud.ppg,deltaTvd:Math.abs(t.topTvd-t.bottomTvd),direction:"Down",force:t.volumeBbl*t.ppg*42}))},jobSummary:i,keyResults:r,safetyStatus:o,buoyancyAndWeight:d,volumeCalcs:c,hydrostaticPressure:m,hookloadCalcs:u,stretchCalcs:p,forceAnalysis:h,uTubeEffect:x,volumes:g,operations:b,keyVolumes:[{length:e.inputs.liner.length,bblFt:e.capacities.linerInternal,volume:e.inputs.liner.length*e.capacities.linerInternal},{length:e.geometry.ratHoleFt,bblFt:e.capacities.openHoleAnnulus,volume:e.geometry.ratHoleFt*e.capacities.openHoleAnnulus}],cementForces:{table:e.cementSegments.map(t=>({fluid:t.label,annulusPpg:t.ppg,insidePpg:e.inputs.mud.ppg,deltaTvd:Math.abs(t.topTvd-t.bottomTvd),direction:"Down",force:t.volumeBbl*t.ppg*42})),originalBuoyedWeight:d.linerBuoyedWeight,finalBuoyedWeight:d.linerBuoyedWeight+e.plugForces.bumpForceLbs,totalForceChange:e.plugForces.bumpForceLbs,totalUTubePsi:e.plugForces.hydrostaticPsi,shoeDifferentialPsi:.8*e.plugForces.hydrostaticPsi},plots:l||[],torqueDragResult:a||null,torqueDragRotate:a||null,torqueDragNoRotate:null}}(calculateEnhancedCementingJob({casing:_,liner:G,dp1:K,dp2:X,dpConfig:i,mud:ge,spacers:fe,cements:ve,displacements:Ne,holeOverlap:{...ce,shearStrengthPsi:H,pumpStrokeToleranceBbl:W},landingCollarMd:parseFloat(ue.md||"0"),totalDepthMd:parseFloat(he.md||"0"),setdownForceLbs:parseFloat(u)||0,hookloadSF:parseFloat(x)||1,forceSF:parseFloat(j)||1,findTvdFromMd:e=>parseFloat(ct(e)),dartLaunchVolumeBbl:parseFloat(I)||0}),o,c||"",(null==Oe?void 0:Oe.plots)||[],(null==Oe?void 0:Oe.torqueDragResult)||null);Re(e)}s("results"),n("dashboard")}catch(e){We(`Calculation failed: ${e instanceof Error?e.message:"Unknown error"}`),$e(!0)}finally{He(!1)}},[Ie,_,G,K,X,i,ge,fe,ve,Ne,ce,ue.md,he.md,u,x,j,o,c,ct,null==Oe?void 0:Oe.plots,null==Oe?void 0:Oe.torqueDragResult,I,H,W]),handleProcessSurveyData=()=>{const e=Pe.trim().split("\n").map(e=>{const t=e.trim().split(/[\s,]+/);return[t[0]||"0",t[1]||"0",t[2]||"0"]}).filter(e=>3===e.length&&e.every(e=>!isNaN(parseFloat(e))));Me(e),We(`${e.length} survey data rows processed successfully! TVD values will now be auto-calculated.`),$e(!0)},handleTorqueDragAnalysis=()=>{const e=parsePipe(_,i),t=parsePipe(G,i),l=parsePipe(K,i),a=parsePipe(X,i,!0),r=[{id:"dp1",from:0,to:l.md,od:l.od,id_tube:l.id,wt:l.wt},{id:"dp2",from:l.md,to:a.md,od:a.od,id_tube:a.id,wt:a.wt},{id:"liner",from:a.md,to:t.md,od:t.od,id_tube:t.id,wt:t.wt}].filter(e=>e.to>e.from),o=calculateTorqueDrag({survey:Le.map(e=>({md:parseFloat(e[0]),tvd:parseFloat(e[1]),incl:parseFloat(e[2])})),string:r,mudWeight:parseFloat(ge.ppg),casingFriction:parseFloat(ce.casingFrictionFactor),openHoleFriction:parseFloat(ce.openHoleFrictionFactor),casingShoeMd:e.md,rotate:!0,targetSetdown:parseFloat(u)||15e3,segmentFt:25}),d=calculateTorqueDrag({survey:Le.map(e=>({md:parseFloat(e[0]),tvd:parseFloat(e[1]),incl:parseFloat(e[2])})),string:r,mudWeight:parseFloat(ge.ppg),casingFriction:parseFloat(ce.casingFrictionFactor),openHoleFriction:parseFloat(ce.openHoleFrictionFactor),casingShoeMd:e.md,rotate:!1,targetSetdown:parseFloat(u)||15e3,segmentFt:25}),c={id:"td-hookload",type:"line",title:"T&D Hookload vs Depth",x_field:"depth",y_fields:[{key:"hookload_out",name:"Hookload (tension)",color:"#0ea5e9"},{key:"drag",name:"Drag (Δ tension)",color:"#f97316"}],series:o.plotData,options:{xlabel:"MD (ft)",ylabel:"Force (lbs)"}},m={id:"td-rotate-torque-drag",type:"line",title:"Torque & Drag vs Depth (Rotate ON)",x_field:"depth",y_fields:[{key:"torque",name:"Torque",color:"#10b981"},{key:"drag",name:"Drag",color:"#ef4444"}],series:o.plotData,options:{xlabel:"MD (ft)",ylabel:"Force / Torque"}},p={id:"td-norotate-torque-drag",type:"line",title:"Torque & Drag vs Depth (Rotate OFF)",x_field:"depth",y_fields:[{key:"torque",name:"Torque",color:"#14b8a6"},{key:"drag",name:"Drag",color:"#f97316"}],series:d.plotData,options:{xlabel:"MD (ft)",ylabel:"Force / Torque"}},h={id:"well-path",type:"line",title:"Well Path (Inclination)",x_field:"md",y_fields:[{key:"inc",name:"Inclination",color:"#6366f1"}],series:Le.map(e=>({md:parseFloat(e[0]),inc:parseFloat(e[2])})).filter(e=>Number.isFinite(e.md)&&Number.isFinite(e.inc)),options:{xlabel:"MD (ft)",ylabel:"Inc (°)"}};Re(e=>e?{...e,torqueDragResult:o,torqueDragRotate:o,torqueDragNoRotate:d,plots:[...(e.plots||[]).filter(e=>!["td-hookload","td-rotate-torque-drag","td-norotate-torque-drag","well-path"].includes(e.id)),c,m,p,h]}:null),nt(o.summary+"\n---\n"+d.summary),s("results"),n("td")},handlePackerForceSim=async()=>{tt(!0),lt(null);const e=await(async e=>{if(!Z)return"AI features are disabled. Please configure your API key to enable packer force simulation.";const{dp1:t,dp2:s,mud:l,surveyData:a,packerForce:n}=e,i=parseFloat(t.length||"0"),r=parseFloat(s.length||"0"),o=a.length>0?Math.max(...a.map(e=>parseFloat(e[2]||"0"))):0,d=(i*parseFloat(t.wt||"0")+r*parseFloat(s.wt||"0"))*((65.5-parseFloat(l.ppg||"0"))/65.5),c=d*Math.sin(degreesToRadians(o))*.25,m=`\n    You are a Completions Engineer providing a concise summary for a packer setting force simulation.\n\n    **Task:**\n    Provide a simplified summary of the packer setting force calculation. Explain that the surface slack-off weight must account for the desired downhole force plus the buoyed weight of the string and frictional losses. Do not show the step-by-step math. Present the final result clearly.\n\n    **Output Format:**\n    - A main heading "Packer Setting Force Summary".\n    - A short paragraph explaining the principle.\n    - A bulleted list showing the key components:\n        - Buoyed Weight of the string: ${d.toLocaleString(void 0,{maximumFractionDigits:0})} lbs\n        - Estimated Frictional Drag: ${c.toLocaleString(void 0,{maximumFractionDigits:0})} lbs\n        - Required Downhole Force: ${n.toLocaleString()} lbs\n    - A concluding sentence with the final, bolded **Required Surface Slack-off Weight**. The final weight is the sum of the three components above.\n  `;try{return(await Z.models.generateContent({model:"gemini-2.5-flash",contents:m})).text??""}catch(u){return"An error occurred during packer force simulation. Please check your API configuration and try again."}})({dp1:K,dp2:X,mud:ge,surveyData:Le,packerForce:parseFloat(Xe)});lt(e),tt(!1)},handleDeproAnalysis=async()=>{if(!Oe)return;rt(!0),dt(null);const e={inputs:{casing:_,liner:G,dp1:K,dp2:X,holeOverlap:ce,mud:ge,fluids:{spacers:fe,cements:ve,displacements:Ne},surveyData:Le},calculations:Oe},t=await(async e=>{if(!Z)return{title:"AI Disabled",executiveSummary:"AI features are disabled. Please configure your API key to enable DEPRO analysis.",introduction:"",jobDetails:"",volumetricAnalysis:"",mechanicalAnalysis:"",conclusion:""};const t={title:"",executiveSummary:"",introduction:"",jobDetails:"",volumetricAnalysis:"",mechanicalAnalysis:"",conclusion:""},s=`\nYou are an expert specializing in the DEPRO drilling software. Your task is to provide a summarized but insightful analysis of a simulated liner cementing job.\n\n**Source 1: DEPRO Software Capabilities**\n\nDEPRO is a comprehensive torque, drag, and hydraulics program. Using this software, users can reduce many of the risks encountered in drilling and completion operations. DEPRO predicts the limits in the length of a horizontal well based on specific friction factors, recommends rig specifications, and evaluates the required weight to set a packer. For hydraulics, DEPRO covers downhole circulating pressures, surge and swab, equivalent circulation densities (ECD), bit optimization, hole cleaning, and volumetric displacements. Using DEPRO, downhole drilling hydraulic conditions can be fully examined, and any potential problems can be identified prior to field execution. If you are interested in both TADPRO and HYDPRO, DEPRO is the package for you. It combines all the essential parts of both software programs.\n    \n\n**Source 2: Simulated Data from DEPRO for a Liner Cementing Job**\nThe following data represents the inputs and calculated outputs.\n\`\`\`json\n${JSON.stringify(e,null,2)}\n\`\`\`\n\n**Your Task:**\nGenerate a structured report in JSON format that summarizes the analysis.\n- **Analyze the data in Source 2** through the lens of the capabilities described in **Source 1**.\n- **Keep the content of each section concise and summary-level.**\n- **Cite all data points from Source 2 with [i]**.\n- **Bold the most important findings** using markdown (**).\n- For the 'jobDetails', 'volumetricAnalysis', and 'mechanicalAnalysis' sections, use markdown bullet points for clarity.\n\nPopulate the following JSON schema:\n`;try{const e=((await Z.models.generateContent({model:"gemini-2.5-flash",contents:s,config:{responseMimeType:"application/json",responseSchema:{type:V.OBJECT,properties:{title:{type:V.STRING},executiveSummary:{type:V.STRING},introduction:{type:V.STRING},jobDetails:{type:V.STRING},volumetricAnalysis:{type:V.STRING},mechanicalAnalysis:{type:V.STRING},conclusion:{type:V.STRING}},required:Object.keys(t)}}})).text??"{}").trim();return JSON.parse(e)}catch(l){return{title:"Error Generating Report",executiveSummary:"An error occurred while generating the DEPRO analysis. Please check your API configuration and try again.",introduction:"",jobDetails:"",volumetricAnalysis:"",mechanicalAnalysis:"",conclusion:""}}})(e);dt(t),rt(!1)},renderWellConfigTab=()=>e.jsxs("div",{className:"p-6 space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Well Configuration"}),e.jsxs("div",{className:"flex space-x-2 p-1 rounded-full bg-slate-200",children:[e.jsx("button",{onClick:()=>r("single"),className:"px-4 py-1.5 rounded-full text-sm font-semibold transition-colors "+("single"===i?"bg-white text-blue-600 shadow":"text-slate-600 hover:bg-slate-300"),children:"Single DP"}),e.jsx("button",{onClick:()=>r("dual"),className:"px-4 py-1.5 rounded-full text-sm font-semibold transition-colors "+("dual"===i?"bg-white text-blue-600 shadow":"text-slate-600 hover:bg-slate-300"),children:"Dual DP (Tapered)"})]})]}),e.jsxs("div",{className:"bg-slate-50 p-6 rounded-xl shadow-inner space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-700",children:"Job Information & Parameters"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 items-end",children:[e.jsxs("label",{className:"block",htmlFor:"well-name",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Well Name"}),e.jsx("input",{id:"well-name",type:"text",value:o,onChange:e=>d(e.target.value),className:"mt-1 block w-full p-2 border border-slate-300 rounded-md bg-white text-slate-900"})]}),e.jsxs("label",{className:"block",htmlFor:"job-date",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Date"}),e.jsx("input",{id:"job-date",type:"date",value:c,onChange:e=>m(e.target.value),className:"mt-1 block w-full p-2 border border-slate-300 rounded-md bg-white text-slate-900"})]}),e.jsxs("label",{className:"block",htmlFor:"setdown-force",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Setdown Force (lbs)"}),e.jsx("input",{id:"setdown-force",type:"number",value:u,onChange:e=>p(e.target.value),className:"mt-1 block w-full p-2 border border-slate-300 rounded-md bg-white text-slate-900"})]}),e.jsxs("label",{className:"block",htmlFor:"hookload-sf",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Hookload SF"}),e.jsx("input",{id:"hookload-sf",type:"number",step:"0.05",value:x,onChange:e=>g(e.target.value),className:"mt-1 block w-full p-2 border border-slate-300 rounded-md bg-white text-slate-900"})]}),e.jsxs("label",{className:"block",htmlFor:"force-sf",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Force SF"}),e.jsx("input",{id:"force-sf",type:"number",step:"0.05",value:j,onChange:e=>y(e.target.value),className:"mt-1 block w-full p-2 border border-slate-300 rounded-md bg-white text-slate-900"})]}),e.jsxs("label",{className:"block",htmlFor:"dart-launch-vol",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Dart Launch Vol (bbl)"}),e.jsx("input",{id:"dart-launch-vol",type:"number",step:"0.1",value:I,onChange:e=>B(e.target.value),className:"mt-1 block w-full p-2 border border-slate-300 rounded-md bg-white text-slate-900"})]})]})]}),e.jsx(PipeInput,{label:"Parent Casing",pipe:_,setPipe:U,pipeData:pt}),e.jsx(PipeInput,{label:"Liner",pipe:G,setPipe:Y,pipeData:ht}),e.jsx(PipeInput,{label:"DP1 (Upper)",pipe:K,setPipe:J,pipeData:xt,gradeOptions:oe,gradeLabel:"DP1 Grade",deriveDepths:e=>{const t=e.md?parseFloat(e.md):parseFloat(e.length||"0"),s=ct(t);return{md:String(t||0),tvd:s}}}),e.jsx(PipeInput,{label:"DP2 (Lower)",pipe:X,setPipe:ee,pipeData:xt,gradeOptions:oe,gradeLabel:"DP2 Grade",disabled:"single"===i,deriveDepths:e=>{const t=parseFloat(K.length||"0"),s=e.md?parseFloat(e.md):t+parseFloat(e.length||"0"),l=ct(s);return{md:String(s||0),tvd:l}}}),e.jsxs("div",{className:"bg-slate-50 p-6 rounded-xl shadow-inner space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-700",children:"Depths & Dimensions"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 items-end",children:[e.jsxs("label",{className:"block",htmlFor:"open-hole-id",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Open Hole ID (in)"}),e.jsx("input",{id:"open-hole-id",type:"number",value:ce.openHoleId,onChange:e=>me({...ce,openHoleId:e.target.value}),className:"mt-1 block w-full p-2 border border-slate-300 rounded-md bg-white text-slate-900"})]}),e.jsxs("label",{className:"block",htmlFor:"liner-overlap",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Liner Overlap (ft)"}),e.jsx("input",{id:"liner-overlap",type:"number",value:ce.linerOverlap,onChange:e=>me({...ce,linerOverlap:e.target.value}),className:"mt-1 block w-full p-2 border border-slate-300 rounded-md bg-white text-slate-900"})]}),e.jsxs("label",{className:"block",htmlFor:"landing-collar-md",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Landing Collar MD (ft)"}),e.jsx("input",{id:"landing-collar-md",type:"number",value:ue.md,onChange:e=>pe({...ue,md:e.target.value}),className:"mt-1 block w-full p-2 border border-slate-300 rounded-md bg-white text-slate-900"})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Landing Collar TVD (ft)"}),e.jsx("span",{className:"mt-1 block w-full p-2 border border-slate-300 rounded-md bg-slate-200 text-slate-600 cursor-not-allowed text-center",children:ue.tvd})]}),e.jsxs("label",{className:"block",htmlFor:"total-depth-md",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Total Depth MD (ft)"}),e.jsx("input",{id:"total-depth-md",type:"number",value:he.md,onChange:e=>xe({...he,md:e.target.value}),className:"mt-1 block w-full p-2 border border-slate-300 rounded-md bg-white text-slate-900"})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Total Depth TVD (ft)"}),e.jsx("span",{className:"mt-1 block w-full p-2 border border-slate-300 rounded-md bg-slate-200 text-slate-600 cursor-not-allowed text-center",children:he.tvd})]}),e.jsxs("label",{className:"block",htmlFor:"shoe-track-length",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Shoe Track Length (ft)"}),e.jsx("input",{id:"shoe-track-length",type:"number",value:ce.shoeTrackLength,onChange:e=>me({...ce,shoeTrackLength:e.target.value}),className:"mt-1 block w-full p-2 border border-slate-300 rounded-md bg-white text-slate-900"})]}),e.jsxs("label",{className:"block",htmlFor:"cement-thickening-time",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Cement Thickening Time (min)"}),e.jsx("input",{id:"cement-thickening-time",type:"number",value:ce.cementThickeningTime,onChange:e=>me({...ce,cementThickeningTime:e.target.value}),className:"mt-1 block w-full p-2 border border-slate-300 rounded-md bg-white text-slate-900"})]}),e.jsxs("label",{className:"block",htmlFor:"shear-strength",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Shear Strength (psi)"}),e.jsx("input",{id:"shear-strength",type:"number",value:H,onChange:e=>E(e.target.value),className:"mt-1 block w-full p-2 border border-slate-300 rounded-md bg-white text-slate-900"})]}),e.jsxs("label",{className:"block",htmlFor:"pump-stroke-tol",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Pump Stroke Tol (bbl)"}),e.jsx("input",{id:"pump-stroke-tol",type:"number",step:"0.1",value:W,onChange:e=>q(e.target.value),className:"mt-1 block w-full p-2 border border-slate-300 rounded-md bg-white text-slate-900"})]})]})]})]});return e.jsxs("div",{className:"min-h-screen bg-slate-100 font-sans text-slate-800 antialiased flex flex-col md:flex-row",children:[Ee&&e.jsxs(Modal$1,{title:"Information",onClose:()=>$e(!1),children:[e.jsx("p",{children:ze}),e.jsx("button",{onClick:()=>$e(!1),className:"mt-6 w-full bg-blue-600 text-white p-2 rounded-md hover:bg-blue-700 transition-colors",children:"OK"})]}),e.jsx(TermExplainerModal,{isVisible:qe,termToExplain:Ue,explainedTerm:Ye,isExplaining:Je,onClose:()=>{_e(!1),Ke(""),Ge("")},onTermChange:Ge,onExplain:async()=>{if(!Ue)return;Ze(!0),Ke("");const e=await(async e=>{if(!e)return"Please enter a term to explain.";if(!Z)return"AI features are disabled. Please configure your API key to enable term explanations.";const t=`\n    Explain the drilling engineering term "${e}" in a simple, clear manner for someone new to the industry. Provide a brief definition and describe its importance or role in drilling operations.\n    `;try{return(await Z.models.generateContent({model:"gemini-2.5-flash",contents:t})).text??""}catch(s){return"An error occurred while explaining the term. Please check your API configuration and try again."}})(Ue);Ke(e),Ze(!1)}}),e.jsxs("div",{className:"w-full md:w-72 bg-white shadow-xl p-4 flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold mb-6 text-blue-700 flex items-center",children:[e.jsx(w,{className:"mr-2"}),"Drilling App"]}),e.jsxs("nav",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>s("well-config"),className:"flex items-center w-full p-3 rounded-lg transition-colors text-left "+("well-config"===t?"bg-blue-100 text-blue-700 font-semibold":"hover:bg-slate-100"),children:[e.jsx(F,{className:"mr-3",size:20}),"Well Config"]}),e.jsxs("button",{onClick:()=>s("fluid-config"),className:"flex items-center w-full p-3 rounded-lg transition-colors text-left "+("fluid-config"===t?"bg-blue-100 text-blue-700 font-semibold":"hover:bg-slate-100"),children:[e.jsx(S,{className:"mr-3",size:20}),"Fluid Config"]}),e.jsxs("button",{onClick:()=>s("fluids"),className:"flex items-center w-full p-3 rounded-lg transition-colors text-left "+("fluids"===t?"bg-blue-100 text-blue-700 font-semibold":"hover:bg-slate-100"),children:[e.jsx(S,{className:"mr-3",size:20}),"Fluid Inputs"]}),e.jsxs("button",{onClick:()=>s("survey"),className:"flex items-center w-full p-3 rounded-lg transition-colors text-left "+("survey"===t?"bg-blue-100 text-blue-700 font-semibold":"hover:bg-slate-100"),children:[e.jsx(C,{className:"mr-3",size:20}),"Paste Survey"]}),e.jsxs("button",{onClick:()=>s("advanced"),className:"flex items-center w-full p-3 rounded-lg transition-colors text-left "+("advanced"===t?"bg-blue-100 text-blue-700 font-semibold":"hover:bg-slate-100"),children:[e.jsx(b,{className:"mr-3",size:20}),"Advanced Analysis"]}),e.jsxs("button",{onClick:()=>s("results"),className:`flex items-center w-full p-3 rounded-lg transition-colors text-left ${"results"===t?"bg-blue-100 text-blue-700 font-semibold":"hover:bg-slate-100"} ${Oe?"":"opacity-50 cursor-not-allowed"}`,disabled:!Oe,children:[e.jsx(k,{className:"mr-3",size:20}),"Results"]}),e.jsxs("div",{className:"mt-6 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-600 px-1",children:[e.jsx("span",{children:"Use Python Backend"}),e.jsx("input",{type:"checkbox","aria-label":"Toggle Python backend calculations",checked:Ie,onChange:e=>Be(e.target.checked)})]}),e.jsx("button",{onClick:gt,disabled:Ve,className:`w-full flex items-center justify-center p-3 rounded-lg ${Ve?"bg-green-300 cursor-wait":"bg-green-500 hover:bg-green-600"} text-white font-bold text-lg transition-colors shadow-lg`,children:Ve?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"mr-2 animate-spin",size:20}),"Calculating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"mr-2",size:20})," Run Calculation"]})})]})]})]}),e.jsxs("div",{className:"space-y-4 mt-6",children:[e.jsxs("button",{onClick:()=>_e(!0),className:"w-full flex items-center justify-center p-3 rounded-lg bg-slate-500 text-white font-bold text-lg hover:bg-slate-600 transition-colors shadow-lg",children:[e.jsx(T,{className:"mr-2",size:20})," Explain Term"]}),e.jsxs("button",{onClick:()=>{var e,t;if(!Oe)return;const s=new $({unit:"pt",format:"a4"});let l=36;s.setFontSize(16),s.text("Liner Cementing Job Report",36,l),l+=18,s.setFontSize(10),s.text(`Well: ${Oe.jobSummary.wellName}    Date: ${Oe.jobSummary.date}`,36,l),l+=16,z(s,{startY:l,head:[["Metric","Value"]],theme:"striped",styles:{fontSize:9},body:[["Initial Hookload (lbs)",`${Math.round(Oe.keyResults.initialHookload).toLocaleString()}`],["Post-Cement Hookload (lbs)",`${Math.round(Oe.keyResults.postCementHookload).toLocaleString()}`],["Drill String Stretch (in)",`${Oe.keyResults.drillStringStretch.toFixed(2)}`],["Net Force on Liner Hanger (lbs)",`${Math.round(Oe.keyResults.netForceOnLinerHanger).toLocaleString()}`],["U-Tube Pressure Diff (psi)",`${Math.round(Oe.keyResults.uTubePressureDifferential).toLocaleString()}`]]}),(null==(t=null==(e=Oe.cementForces)?void 0:e.table)?void 0:t.length)&&z(s,{startY:l,head:[["Fluid","Annulus PPG","Inside PPG","ΔTVD (ft)","Direction","Force (lbs)"]],styles:{fontSize:8},headStyles:{fillColor:[30,58,138]},body:Oe.cementForces.table.map(e=>[e.fluid,e.annulusPpg.toFixed(2),e.insidePpg.toFixed(2),e.deltaTvd.toFixed(0),e.direction,Math.round(e.force).toLocaleString()])}),s.save(`${Oe.jobSummary.wellName||"job"}-report.pdf`)},className:"w-full flex items-center justify-center p-3 rounded-lg bg-blue-500 text-white font-bold text-lg hover:bg-blue-600 transition-colors shadow-lg",children:[e.jsx(L,{className:"mr-2",size:20})," Export Report"]})]})]}),e.jsx("main",{className:"flex-1 p-6 md:p-10 bg-slate-100 overflow-y-auto",children:e.jsx(Q,{calculationType:"Main App",onRetry:gt,children:e.jsx("div",{className:"bg-white rounded-2xl shadow-xl min-h-full",children:(()=>{switch(t){case"well-config":default:return renderWellConfigTab();case"fluid-config":return e.jsxs("div",{className:"p-6 space-y-6 animate-fade-in",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-4",children:"Configure Fluids"}),e.jsxs("div",{className:"bg-slate-50 p-6 rounded-xl shadow-inner space-y-4 max-w-md mx-auto",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-700 mb-2",children:"Number of Fluids"}),e.jsx(FluidControl,{label:"Spacers",count:Fe,setCount:Se}),e.jsx(FluidControl,{label:"Cements",count:Ce,setCount:ke}),e.jsx(FluidControl,{label:"Displacement Fluids",count:De,setCount:Te})]})]});case"fluids":return e.jsxs("div",{className:"p-6 space-y-6 animate-fade-in",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Define Fluids"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-slate-50 p-6 rounded-xl shadow-inner",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-700 mb-4",children:"Base Mud"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 items-end",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Fluid"}),e.jsx("span",{className:"mt-1 block w-full p-2 border border-slate-300 rounded-md bg-slate-200 text-slate-700 text-center",children:"Base Mud"})]}),e.jsxs("label",{className:"block",htmlFor:"mud-weight-ppg",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Weight (ppg)"}),e.jsx("input",{id:"mud-weight-ppg",type:"number",value:ge.ppg,onChange:e=>be({ppg:e.target.value}),className:"mt-1 block w-full p-2 border border-slate-300 rounded-md bg-white text-slate-900","aria-describedby":"mud-weight-help",min:"8",max:"20",step:"0.1",placeholder:"Enter mud weight in PPG"}),e.jsx("div",{id:"mud-weight-help",className:"text-xs text-slate-500 mt-1",children:"Drilling fluid density in pounds per gallon (typical: 9-15 PPG)"})]})]})]}),e.jsx(FluidInputs,{fluids:fe,setFluids:je,label:"Spacers"}),e.jsx(FluidInputs,{fluids:ve,setFluids:ye,label:"Cements"}),e.jsx(FluidInputs,{fluids:Ne,setFluids:we,label:"Displacement Fluids"})]})]});case"survey":return e.jsxs("div",{className:"p-6 space-y-6 max-w-2xl mx-auto animate-fade-in",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Paste Survey Data"}),e.jsxs("div",{className:"bg-slate-50 p-6 rounded-xl shadow-inner space-y-4",children:[e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Paste data here (MD, TVD, Inc. Angle)"}),e.jsx("textarea",{className:"mt-1 block w-full h-40 p-2 border border-slate-300 rounded-md font-mono text-sm bg-white text-slate-900",value:Pe,onChange:e=>Ae(e.target.value),placeholder:"e.g.,\n100 100 0.5\n200 199.8 1.2\n300 299.1 2.5"})]}),e.jsxs("button",{onClick:handleProcessSurveyData,className:"w-full flex items-center justify-center p-3 rounded-lg bg-blue-600 text-white font-medium hover:bg-blue-700 transition-colors shadow-md",children:[e.jsx(R,{className:"mr-2",size:20})," Process Data"]})]}),Le.length>0&&e.jsxs("div",{className:"bg-slate-50 p-6 rounded-xl shadow-inner",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-700 mb-4",children:["Processed Survey (",Le.length," points)"]}),e.jsx("div",{className:"max-h-60 overflow-y-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-slate-200 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2 font-medium text-slate-700",children:"MD (ft)"}),e.jsx("th",{className:"text-left p-2 font-medium text-slate-700",children:"TVD (ft)"}),e.jsx("th",{className:"text-left p-2 font-medium text-slate-700",children:"Inc. (°)"})]})}),e.jsx("tbody",{className:"text-slate-600",children:Le.map((t,s)=>e.jsxs("tr",{className:"border-t border-slate-200",children:[e.jsx("td",{className:"p-2",children:parseFloat(t[0]).toFixed(1)}),e.jsx("td",{className:"p-2",children:parseFloat(t[1]).toFixed(1)}),e.jsx("td",{className:"p-2",children:parseFloat(t[2]).toFixed(2)})]},`${t[0]}-${t[1]}-${t[2]}-${s}`))})]})})]})]});case"results":return Oe?e.jsxs("div",{className:"p-6 animate-fade-in",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Results"}),e.jsxs("div",{className:"flex items-center space-x-2 p-1 rounded-full bg-slate-100 border",children:[e.jsx(ResultTabButton,{label:"Dashboard",value:"dashboard",icon:e.jsx(k,{size:16}),isActive:"dashboard"===l,onClick:n}),e.jsx(ResultTabButton,{label:"Details",value:"details",icon:e.jsx(P,{size:16}),isActive:"details"===l,onClick:n}),e.jsx(ResultTabButton,{label:"Cement Table",value:"cement",icon:e.jsx(P,{size:16}),isActive:"cement"===l,onClick:n}),e.jsx(ResultTabButton,{label:"T&D",value:"td",icon:e.jsx(b,{size:16}),isActive:"td"===l,onClick:n}),e.jsx(ResultTabButton,{label:"AI",value:"ai",icon:e.jsx(A,{size:16}),isActive:"ai"===l,onClick:n})]})]}),e.jsxs("div",{children:["dashboard"===l&&e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6 animate-fade-in",children:[e.jsx("div",{className:"xl:col-span-2",children:e.jsx(WellAnalysisReport,{casing:_,liner:G,dp1:K,spacers:fe,cements:ve,displacements:Ne,holeOverlap:ce,landingCollar:ue,totalDepth:he,calculations:null})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(CalculationCard,{title:"KEY CALCULATION RESULTS",children:[e.jsx(DataRow,{label:"Initial Hookload",value:Oe.keyResults.initialHookload,unit:"lbs"}),e.jsx(DataRow,{label:"Post-Cement Hookload",value:Oe.keyResults.postCementHookload,unit:"lbs"}),e.jsx(DataRow,{label:"Drill String Stretch",value:Oe.keyResults.drillStringStretch,unit:"in"}),e.jsx(DataRow,{label:"Net Force on Liner Hanger",value:Oe.keyResults.netForceOnLinerHanger,unit:"lbs"}),e.jsx(DataRow,{label:"U-Tube Pressure Diff",value:Oe.keyResults.uTubePressureDifferential,unit:"psi"}),e.jsx(DataRow,{label:"Critical Pump Rate",value:Oe.keyResults.criticalPumpRate,unit:"bpm"})]}),e.jsxs(CalculationCard,{title:"SAFETY STATUS INDICATORS",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-600",children:"Hookload Status:"}),e.jsxs("span",{className:"font-semibold px-2 py-0.5 rounded flex items-center "+("OK"===Oe.safetyStatus.hookloadStatus?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:["OK"===Oe.safetyStatus.hookloadStatus?e.jsx(O,{size:14,className:"mr-1"}):e.jsx(h,{size:14,className:"mr-1"}),Oe.safetyStatus.hookloadStatus]})]}),e.jsx(DataRow,{label:"Net Force with SF",value:Oe.safetyStatus.netForceStatus,unit:""}),e.jsx(DataRow,{label:"Total Stretch",value:Oe.safetyStatus.stretchStatus,unit:""})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(CalculationCard,{title:"CEMENT OPERATIONAL PARAMETERS",children:[e.jsx(DataRow,{label:"Cement Volume",value:Oe.volumes.cementVolume,unit:"bbls"}),e.jsx(DataRow,{label:"Displacement Volume",value:Oe.volumes.displacementVolume,unit:"bbls"}),e.jsx(DataRow,{label:"Plug Drop",value:Oe.volumes.plugDrop,unit:"bbls"}),e.jsx(DataRow,{label:"Wait on Cement",value:Oe.operations.waitOnCement,unit:"min"}),e.jsx(DataRow,{label:"Cement Travel Time",value:Oe.operations.cementTravelTime,unit:"min"})]}),e.jsxs(CalculationCard,{title:"VOLUMES & CIRCULATION",children:[e.jsx(DataRow,{label:"Total Well Volume",value:Oe.volumes.totalWellVolume,unit:"bbls"}),e.jsx(DataRow,{label:"Liner Displacement Volume",value:Oe.volumes.linerDisplacementVolume,unit:"bbls"}),e.jsx(DataRow,{label:"Surface to Shoe",value:Oe.volumes.surfaceToShoe,unit:"bbls"}),e.jsx(DataRow,{label:"Circulation Rate",value:Oe.operations.circulationRate,unit:"bpm"})]})]})]}),"details"===l&&e.jsx(DetailedResults,{calculations:Oe}),"cement"===l&&e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Cement Table"}),e.jsx("p",{className:"text-gray-600",children:"Cement table component will be implemented later..."})]}),"td"===l&&e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Torque & Drag Table"}),e.jsx("p",{className:"text-gray-600",children:"Torque & Drag table component will be implemented later..."})]}),"ai"===l&&e.jsx(AIInsights,{calculations:Oe})]})]}):e.jsxs("div",{className:"p-6 animate-fade-in",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-6",children:"Results"}),e.jsx("div",{className:"text-center py-10 bg-slate-50 rounded-lg",children:e.jsx("p",{className:"text-slate-500",children:'Press "Run Calculation" to see results here.'})})]});case"advanced":return e.jsxs("div",{className:"p-6 space-y-8 max-w-4xl mx-auto animate-fade-in",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Advanced Analysis"}),e.jsxs("div",{className:"bg-slate-50 p-6 rounded-xl shadow-inner",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-700 mb-4 flex items-center",children:[e.jsx(f,{className:"mr-2 text-cyan-500"}),"DEPRO Expert Analysis"]}),e.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"Leverage AI to analyze the calculated results in the context of the DEPRO software suite. This provides a comprehensive report covering hydraulics, torque & drag, and operational risks."}),e.jsx("button",{onClick:handleDeproAnalysis,disabled:!Oe||it,className:"w-full flex items-center justify-center p-3 rounded-lg bg-cyan-600 text-white font-medium hover:bg-cyan-700 transition-colors shadow-md disabled:bg-cyan-300 disabled:cursor-not-allowed",children:it?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"animate-spin mr-2"}),"Generating Report..."]}):"Generate DEPRO Analysis"}),ot&&e.jsxs("div",{className:"mt-6 p-6 bg-white rounded-lg shadow-md",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-4 text-center",children:ot.title}),e.jsx("div",{className:"prose prose-sm max-w-none space-y-4",children:Object.entries(ot).map(([t,s])=>{if("title"===t||!s)return null;const l=t.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase());return e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-700",children:l}),e.jsx(SafeHtml,{html:s.replace(/\[i\]/g,'<sup class="text-cyan-600 font-bold">[i]</sup>')})]},t)})})]})]}),e.jsxs("div",{className:"bg-slate-50 p-6 rounded-xl shadow-inner",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-700 mb-4 flex items-center",children:[e.jsx(b,{className:"mr-2 text-indigo-500"}),"Torque & Drag Analysis"]}),e.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"Run a deterministic soft-string model to analyze torque, drag, and hookload. Requires survey data."}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("label",{className:"block",htmlFor:"casing-friction-factor",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Casing Friction Factor"}),e.jsx("input",{id:"casing-friction-factor",type:"number",step:"0.01",value:ce.casingFrictionFactor,onChange:e=>me({...ce,casingFrictionFactor:e.target.value}),className:"mt-1 block w-full p-2 border border-slate-300 rounded-md bg-white text-slate-900","aria-describedby":"casing-friction-help",min:"0.1",max:"0.5"}),e.jsx("div",{id:"casing-friction-help",className:"text-xs text-slate-500 mt-1",children:"Typical range: 0.15-0.30 for cased hole sections"})]}),e.jsxs("label",{className:"block",htmlFor:"open-hole-friction-factor",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Open Hole Friction Factor"}),e.jsx("input",{id:"open-hole-friction-factor",type:"number",step:"0.01",value:ce.openHoleFrictionFactor,onChange:e=>me({...ce,openHoleFrictionFactor:e.target.value}),className:"mt-1 block w-full p-2 border border-slate-300 rounded-md bg-white text-slate-900","aria-describedby":"open-hole-friction-help",min:"0.15",max:"0.6"}),e.jsx("div",{id:"open-hole-friction-help",className:"text-xs text-slate-500 mt-1",children:"Typical range: 0.25-0.40 for open hole sections"})]})]}),e.jsx("button",{onClick:handleTorqueDragAnalysis,disabled:Le.length<2,className:"w-full flex items-center justify-center p-3 rounded-lg bg-indigo-600 text-white font-medium hover:bg-indigo-700 transition-colors shadow-md disabled:bg-indigo-300 disabled:cursor-not-allowed",children:"Run T&D Analysis & Generate Plots"}),at&&e.jsx("div",{className:"mt-4 p-4 bg-white rounded-md prose prose-sm max-w-none",children:e.jsx(SafeHtml,{html:at.replace(/\n/g,"<br />")})})]}),e.jsxs("div",{className:"bg-slate-50 p-6 rounded-xl shadow-inner",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-700 mb-4 flex items-center",children:[e.jsx(M,{className:"mr-2 text-teal-500"}),"Packer Setting Force Simulation"]}),e.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"Simulate the required surface slack-off weight to achieve a desired downhole force on the packer."}),e.jsxs("label",{className:"block mb-4",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Required Packer Setting Force (lbs)"}),e.jsx("input",{type:"number",value:Xe,onChange:e=>Qe(e.target.value),className:"mt-1 block w-full p-2 border border-slate-300 rounded-md bg-white text-slate-900"})]}),e.jsx("button",{onClick:handlePackerForceSim,disabled:et,className:"w-full flex items-center justify-center p-3 rounded-lg bg-teal-600 text-white font-medium hover:bg-teal-700 transition-colors shadow-md disabled:bg-teal-300",children:et?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"animate-spin mr-2"}),"Simulating..."]}):"Simulate Packer Force"}),st&&e.jsx("div",{className:"mt-4 p-4 bg-white rounded-md prose prose-sm max-w-none",children:e.jsx(SafeHtml,{html:st,isMarkdown:!0})})]})]})}})()})})})]})};class ne extends N.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e){}render(){return this.state.hasError?e.jsx("div",{className:"p-4 text-sm text-red-700 bg-red-50 rounded-md",children:"Something went wrong. Please refresh."}):this.props.children}}const ie=document.getElementById("root");if(!ie)throw new Error("Could not find root element to mount to");I.createRoot(ie).render(e.jsx(N.StrictMode,{children:e.jsx(ne,{children:e.jsx(App,{})})}));
